2025-07-20 09:41:56 | INFO  | __main__:run:40 | Received query: 'what's the company's leave policy?'
2025-07-20 09:41:56 | INFO  | rag.utils.milvus_manager:__init__:17 | Successfully connected to Milvus.
2025-07-20 09:41:56 | INFO  | rag.utils.milvus_manager:_create_collection_if_not_exists:28 | Collection 'rag_collection' already exists.
2025-07-20 09:41:57 | INFO  | rag.utils.retriever:retrieve:45 | Embedding query and retrieving documents for: 'what's the company's leave policy?'
2025-07-20 09:41:57 | INFO  | rag.utils.retriever:_embed_query:58 | Embedding query (real)...
2025-07-20 09:41:57 | INFO  | rag.utils.retriever:_search_milvus:81 | Searching Milvus for top 50 results...
2025-07-20 09:41:57 | INFO  | __main__:run:45 | Documents: ['Yueniu Tech New Employee Onboarding \nHandbook\nWelcome to Yueniu Tech!\nWe are thrilled to have you join our team. This onboarding handbook is designed to help you \nnavigate your first days, understand our values, policies, and expectations, and ensure a smooth \ntransition into your new role.\n1. About Yueniu Tech\nFounded with the mission to innovate and empower, Yueniu Tech is a technology-driven company \nthat values excellence, creativity, and collaboration. We strive to provide cutting-edge solutions to \nour clients while fostering a dynamic and inclusive workplace.\n2. Company Values\n•\nInnovation: We embrace new ideas and technologies.\n•\nIntegrity: We conduct our business with the highest ethical standards.\n•\nCollaboration: Teamwork is at the heart of our operations.\n•\nCustomer Focus: We prioritize the needs and satisfaction of our clients.\n•\nContinuous Improvement: We are committed to personal and professional growth.\n3. Your First Day', 'intranet:\n•\nCode of Conduct\n•\nEmployee Handbook\n•\nData Protection and Privacy Policy\n•\nEqual Employment Opportunity Policy\n•\nRemote Work Guidelines\nFinal Words\nWe hope this guide gives you a comprehensive overview of what to expect at Yueniu Tech. If you \never have questions or need support, please don’t hesitate to reach out to your manager or the HR \nteam.\nWelcome aboard – we’re excited to have you with us!\nLet me know if you’d like a Google Docs link or formatted Word version as well!', '6.5 Health and Safety\nWe are dedicated to providing a safe work environment. Familiarize yourself with emergency exits, \nfirst aid kits, and safety procedures.\n7. Payroll and Benefits\nEmployees are paid monthly via direct deposit. Standard employee benefits include:\n•\nHealth insurance\n•\nPaid annual leave (minimum 20 days)\n•\nSick leave and bereavement leave\n•\nKiwiSaver contributions (for NZ-based employees)\n•\nProfessional development and training programs\n8. Performance Reviews\nPerformance reviews are conducted biannually to assess your progress, set career goals, and \nidentify training opportunities. We encourage open and constructive feedback between employees \nand managers.\n9. Career Development\nYueniu Tech supports your career growth through:\n•\nInternal job mobility\n•\nAccess to industry conferences and certifications\n•\nLeadership training and mentoring opportunities\nSpeak to your manager or HR about your career path and development goals.\n10. Company Culture and Social Events', "•\nLeadership training and mentoring opportunities\nSpeak to your manager or HR about your career path and development goals.\n10. Company Culture and Social Events\nWe believe that a happy team is a productive team. We regularly host:\n•\nTeam lunches and happy hours\n•\nHackathons and innovation days\n•\nMental health and wellness programs\n•\nMonthly recognition awards\n11. Resignation and Exit Process\nIf you choose to leave Yueniu Tech, we ask that you provide a minimum of four weeks' notice. HR \nwill guide you through the offboarding process and schedule an exit interview to gather feedback.\n12. Important Policies and Documents (Available on the \nIntranet)\nPlease take time to review the following documents, which can be accessed from the company \nintranet:\n•\nCode of Conduct\n•\nEmployee Handbook\n•\nData Protection and Privacy Policy\n•\nEqual Employment Opportunity Policy\n•\nRemote Work Guidelines\nFinal Words", '•\nHR Manager: Sarah Liu – sarah.liu@yueniutech.com\n•\nHR Generalist: Tom Zhang – tom.zhang@yueniutech.com\n•\nPhone: +64 9 123 4567\n6. Workplace Policies\n6.1 Attendance and Punctuality\nRegular attendance is essential. If you are running late or unable to attend work, please notify your \nsupervisor and HR as early as possible.\n6.2 Dress Code\nOur dress code is smart casual unless otherwise specified for meetings or events.\n6.3 IT & Security Policies\nAll employees must adhere to the company’s IT usage and cybersecurity policies. Company \nequipment must be used for professional purposes only.\n6.4 Anti-Harassment Policy\nYueniu Tech is committed to maintaining a workplace free from harassment or discrimination. Any \nconcerns will be taken seriously and addressed promptly.\n6.5 Health and Safety\nWe are dedicated to providing a safe work environment. Familiarize yourself with emergency exits, \nfirst aid kits, and safety procedures.\n7. Payroll and Benefits', '•\nCustomer Focus: We prioritize the needs and satisfaction of our clients.\n•\nContinuous Improvement: We are committed to personal and professional growth.\n3. Your First Day\nOn your first day, please arrive at the reception by 9:00 AM. You will be greeted by our HR \nrepresentative, who will give you a tour of the office and introduce you to your team. Your \nworkstation will be set up, and you’ll receive your ID badge and necessary equipment.\n4. Required Documents\nPlease bring the following documents on your first day:\n•\nValid government-issued ID\n•\nBank account details for payroll setup\n•\nSigned offer letter and employment contract\n•\nCompleted tax forms (IR330 for New Zealand employees)\n•\nWork visa (if applicable)\n5. HR Contacts\nIf you have any questions or concerns, our HR team is here to help:\n•\nHR Manager: Sarah Liu – sarah.liu@yueniutech.com\n•\nHR Generalist: Tom Zhang – tom.zhang@yueniutech.com\n•\nPhone: +64 9 123 4567\n6. Workplace Policies\n6.1 Attendance and Punctuality']
2025-07-20 09:41:57 | INFO  | __main__:run:51 | Passing documents to CrewAI for final report generation...
2025-07-20 09:42:14 | INFO  | __main__:run:58 | 
--- Final Report ---
2025-07-20 09:42:14 | INFO  | __main__:run:59 | ---

# Company Leave Policy

## 1. Types of Leave

- **Paid Time Off (PTO):** Employees accrue PTO based on their length of service. PTO can be used for vacation, personal days, or sick leave.
- **Sick Leave:** Additional sick leave may be available for employees who need time off due to illness.
- **Family and Medical Leave:** Eligible employees can take up to 12 weeks of unpaid leave for certain family and medical reasons.
- **Bereavement Leave:** Employees are entitled to paid leave for the death of an immediate family member.
- **Jury Duty:** Employees must notify their supervisor if called for jury duty and will be paid for the time served.

## 2. Accrual Rates

- **PTO Accrual:** Employees accrue PTO at a rate of 1.25 hours per 40 hours worked, up to a maximum of 240 hours (30 days) per year.
- **Sick Leave Accrual:** Employees accrue 1 hour of sick leave for every 30 hours worked, up to a maximum of 48 hours (6 days) per year.

## 3. Requesting Leave

- Employees must submit a leave request form at least two weeks in advance, if possible.
- Supervisors must approve all leave requests.
- In cases of emergency, employees should notify their supervisor as soon as possible.

## 4. Documentation

- For leaves of absence longer than 3 days, employees may be required to provide a doctor’s note or other documentation.
- For Family and Medical Leave, employees must provide certification from a healthcare provider.

## 5. Return to Work

- Employees on leave must notify their supervisor of their return date at least 48 hours in advance.
- Employees returning from a leave of absence may be required to meet with their supervisor to discuss any accommodations needed.

## 6. Leave Without Pay

- Employees may request leave without pay for personal reasons. These requests are considered on a case-by-case basis and must be approved by a manager.

## 7. Contact Information

- For questions or assistance regarding leave, employees should contact the Human Resources Department.

---
2025-07-20 09:42:14 | INFO  | __main__:run:60 | --------------------

2025-07-20 21:21:13 | INFO  | __main__:run:40 | Received query: 'what's the company's leave policy?'
2025-07-20 21:21:13 | INFO  | rag.utils.milvus_manager:__init__:17 | Successfully connected to Milvus.
2025-07-20 21:21:13 | INFO  | rag.utils.milvus_manager:_create_collection_if_not_exists:28 | Collection 'rag_collection' already exists.
2025-07-20 21:21:13 | INFO  | rag.utils.retriever:retrieve:45 | Embedding query and retrieving documents for: 'what's the company's leave policy?'
2025-07-20 21:21:13 | INFO  | rag.utils.retriever:_embed_query:58 | Embedding query (real)...
2025-07-20 21:21:14 | INFO  | rag.utils.retriever:_search_milvus:81 | Searching Milvus for top 50 results...
2025-07-20 21:21:14 | INFO  | __main__:run:45 | Documents: ['Yueniu Tech New Employee Onboarding \nHandbook\nWelcome to Yueniu Tech!\nWe are thrilled to have you join our team. This onboarding handbook is designed to help you \nnavigate your first days, understand our values, policies, and expectations, and ensure a smooth \ntransition into your new role.\n1. About Yueniu Tech\nFounded with the mission to innovate and empower, Yueniu Tech is a technology-driven company \nthat values excellence, creativity, and collaboration. We strive to provide cutting-edge solutions to \nour clients while fostering a dynamic and inclusive workplace.\n2. Company Values\n•\nInnovation: We embrace new ideas and technologies.\n•\nIntegrity: We conduct our business with the highest ethical standards.\n•\nCollaboration: Teamwork is at the heart of our operations.\n•\nCustomer Focus: We prioritize the needs and satisfaction of our clients.\n•\nContinuous Improvement: We are committed to personal and professional growth.\n3. Your First Day', 'intranet:\n•\nCode of Conduct\n•\nEmployee Handbook\n•\nData Protection and Privacy Policy\n•\nEqual Employment Opportunity Policy\n•\nRemote Work Guidelines\nFinal Words\nWe hope this guide gives you a comprehensive overview of what to expect at Yueniu Tech. If you \never have questions or need support, please don’t hesitate to reach out to your manager or the HR \nteam.\nWelcome aboard – we’re excited to have you with us!\nLet me know if you’d like a Google Docs link or formatted Word version as well!', '6.5 Health and Safety\nWe are dedicated to providing a safe work environment. Familiarize yourself with emergency exits, \nfirst aid kits, and safety procedures.\n7. Payroll and Benefits\nEmployees are paid monthly via direct deposit. Standard employee benefits include:\n•\nHealth insurance\n•\nPaid annual leave (minimum 20 days)\n•\nSick leave and bereavement leave\n•\nKiwiSaver contributions (for NZ-based employees)\n•\nProfessional development and training programs\n8. Performance Reviews\nPerformance reviews are conducted biannually to assess your progress, set career goals, and \nidentify training opportunities. We encourage open and constructive feedback between employees \nand managers.\n9. Career Development\nYueniu Tech supports your career growth through:\n•\nInternal job mobility\n•\nAccess to industry conferences and certifications\n•\nLeadership training and mentoring opportunities\nSpeak to your manager or HR about your career path and development goals.\n10. Company Culture and Social Events', "•\nLeadership training and mentoring opportunities\nSpeak to your manager or HR about your career path and development goals.\n10. Company Culture and Social Events\nWe believe that a happy team is a productive team. We regularly host:\n•\nTeam lunches and happy hours\n•\nHackathons and innovation days\n•\nMental health and wellness programs\n•\nMonthly recognition awards\n11. Resignation and Exit Process\nIf you choose to leave Yueniu Tech, we ask that you provide a minimum of four weeks' notice. HR \nwill guide you through the offboarding process and schedule an exit interview to gather feedback.\n12. Important Policies and Documents (Available on the \nIntranet)\nPlease take time to review the following documents, which can be accessed from the company \nintranet:\n•\nCode of Conduct\n•\nEmployee Handbook\n•\nData Protection and Privacy Policy\n•\nEqual Employment Opportunity Policy\n•\nRemote Work Guidelines\nFinal Words", '•\nHR Manager: Sarah Liu – sarah.liu@yueniutech.com\n•\nHR Generalist: Tom Zhang – tom.zhang@yueniutech.com\n•\nPhone: +64 9 123 4567\n6. Workplace Policies\n6.1 Attendance and Punctuality\nRegular attendance is essential. If you are running late or unable to attend work, please notify your \nsupervisor and HR as early as possible.\n6.2 Dress Code\nOur dress code is smart casual unless otherwise specified for meetings or events.\n6.3 IT & Security Policies\nAll employees must adhere to the company’s IT usage and cybersecurity policies. Company \nequipment must be used for professional purposes only.\n6.4 Anti-Harassment Policy\nYueniu Tech is committed to maintaining a workplace free from harassment or discrimination. Any \nconcerns will be taken seriously and addressed promptly.\n6.5 Health and Safety\nWe are dedicated to providing a safe work environment. Familiarize yourself with emergency exits, \nfirst aid kits, and safety procedures.\n7. Payroll and Benefits', '•\nCustomer Focus: We prioritize the needs and satisfaction of our clients.\n•\nContinuous Improvement: We are committed to personal and professional growth.\n3. Your First Day\nOn your first day, please arrive at the reception by 9:00 AM. You will be greeted by our HR \nrepresentative, who will give you a tour of the office and introduce you to your team. Your \nworkstation will be set up, and you’ll receive your ID badge and necessary equipment.\n4. Required Documents\nPlease bring the following documents on your first day:\n•\nValid government-issued ID\n•\nBank account details for payroll setup\n•\nSigned offer letter and employment contract\n•\nCompleted tax forms (IR330 for New Zealand employees)\n•\nWork visa (if applicable)\n5. HR Contacts\nIf you have any questions or concerns, our HR team is here to help:\n•\nHR Manager: Sarah Liu – sarah.liu@yueniutech.com\n•\nHR Generalist: Tom Zhang – tom.zhang@yueniutech.com\n•\nPhone: +64 9 123 4567\n6. Workplace Policies\n6.1 Attendance and Punctuality']
2025-07-20 21:21:14 | INFO  | __main__:run:51 | Passing documents to CrewAI for final report generation...
2025-07-20 21:21:30 | INFO  | __main__:run:58 | 
--- Final Report ---
2025-07-20 21:21:30 | INFO  | __main__:run:59 | # Yueniu Tech Leave Policy

## Overview

The company's leave policy at Yueniu Tech is designed to support the well-being and work-life balance of its employees. Below are the key benefits included in the policy:

## Leave Benefits

1. **Paid Annual Leave**
   - Employees are entitled to a minimum of 20 days of paid annual leave per year.

2. **Sick Leave**
   - Employees are provided with sick leave to accommodate health-related absences.

3. **Bereavement Leave**
   - Employees are entitled to bereavement leave to manage personal loss.

## Additional Resources

For more detailed information about the leave policy, please refer to the [Employee Handbook](https://intranet.yueniutech.com/employee-handbook) available on the company intranet.

## Contact Information

If you have any questions or need further clarification, please reach out to the HR team:

- **HR Manager**: Sarah Liu – [sarah.liu@yueniutech.com](mailto:sarah.liu@yueniutech.com)
- **HR Generalist**: Tom Zhang – [tom.zhang@yueniutech.com](mailto:tom.zhang@yueniutech.com)
- **Phone**: +64 9 123 4567

---

**Note:** If you encounter any images related to the leave policy in the Employee Handbook, they will be clearly marked with descriptions and paths as follows:

- **Image:** A chart showing Q3 sales. (Path: /path/to/image.png)

Ensure to check the handbook for visual aids that may provide additional context and information.
2025-07-20 21:21:30 | INFO  | __main__:run:60 | --------------------

2025-07-20 21:44:09 | INFO  | __main__:run:40 | Received query: 'what's the company's leave policy?'
2025-07-20 21:44:09 | INFO  | rag.utils.milvus_manager:__init__:17 | Successfully connected to Milvus.
2025-07-20 21:44:09 | INFO  | rag.utils.milvus_manager:_create_collection_if_not_exists:28 | Collection 'rag_collection' already exists.
2025-07-20 21:44:09 | INFO  | rag.utils.retriever:retrieve:46 | Embedding query and retrieving documents for: 'what's the company's leave policy?'
2025-07-20 21:44:09 | INFO  | rag.utils.retriever:_embed_query:93 | Embedding query (real)...
2025-07-20 21:44:09 | INFO  | rag.utils.retriever:_search_milvus:116 | Searching Milvus for top 50 results...
2025-07-20 21:44:09 | INFO  | rag.utils.retriever:_rerank_documents:65 | Reranking documents...
2025-07-20 21:44:09 | ERROR | rag.utils.retriever:_rerank_documents:81 | Error reranking documents: status_code: 400, body: {'meta': {'billed_units': {'input_tokens': -1.0, 'output_tokens': -1.0}, 'tokens': {'input_tokens': -1.0, 'output_tokens': -1.0}}, 'message': 'The provided model identifier is invalid.'}
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "/private/tmp/rag-demo/rag/src/rag/main.py", line 126, in <module>
    main()
    └ <function main at 0x16b219a80>

  File "/private/tmp/rag-demo/rag/src/rag/main.py", line 116, in main
    run(args.query, mock=args.mock)
    │   │    │           │    └ False
    │   │    │           └ Namespace(command='run', query="what's the company's leave policy?", mock=False)
    │   │    └ "what's the company's leave policy?"
    │   └ Namespace(command='run', query="what's the company's leave policy?", mock=False)
    └ <function run at 0x154d14220>

  File "/private/tmp/rag-demo/rag/src/rag/main.py", line 44, in run
    documents = retriever.retrieve(query)
                │         │        └ "what's the company's leave policy?"
                │         └ <function Retriever.retrieve at 0x16b8a8cc0>
                └ <rag.utils.retriever.Retriever object at 0x16aeffbc0>

  File "/private/tmp/rag-demo/rag/src/rag/utils/retriever.py", line 59, in retrieve
    return self._rerank_documents(query, documents)
           │    │                 │      └ ['Yueniu Tech New Employee Onboarding \nHandbook\nWelcome to Yueniu Tech!\nWe are thrilled to have you join our team. This on...
           │    │                 └ "what's the company's leave policy?"
           │    └ <function Retriever._rerank_documents at 0x16bbd9620>
           └ <rag.utils.retriever.Retriever object at 0x16aeffbc0>

> File "/private/tmp/rag-demo/rag/src/rag/utils/retriever.py", line 68, in _rerank_documents
    rerank_response = co.rerank(
                      │  └ <function V2Client.rerank at 0x16b8aaca0>
                      └ <cohere.bedrock_client.BedrockClientV2 object at 0x16fb0e300>

  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/cohere/v2/client.py", line 1044, in rerank
    raise BadRequestError(
          └ <class 'cohere.errors.bad_request_error.BadRequestError'>

cohere.errors.bad_request_error.BadRequestError: status_code: 400, body: {'meta': {'billed_units': {'input_tokens': -1.0, 'output_tokens': -1.0}, 'tokens': {'input_tokens': -1.0, 'output_tokens': -1.0}}, 'message': 'The provided model identifier is invalid.'}
2025-07-20 21:44:09 | INFO  | __main__:run:45 | Documents: ['Yueniu Tech New Employee Onboarding \nHandbook\nWelcome to Yueniu Tech!\nWe are thrilled to have you join our team. This onboarding handbook is designed to help you \nnavigate your first days, understand our values, policies, and expectations, and ensure a smooth \ntransition into your new role.\n1. About Yueniu Tech\nFounded with the mission to innovate and empower, Yueniu Tech is a technology-driven company \nthat values excellence, creativity, and collaboration. We strive to provide cutting-edge solutions to \nour clients while fostering a dynamic and inclusive workplace.\n2. Company Values\n•\nInnovation: We embrace new ideas and technologies.\n•\nIntegrity: We conduct our business with the highest ethical standards.\n•\nCollaboration: Teamwork is at the heart of our operations.\n•\nCustomer Focus: We prioritize the needs and satisfaction of our clients.\n•\nContinuous Improvement: We are committed to personal and professional growth.\n3. Your First Day', 'intranet:\n•\nCode of Conduct\n•\nEmployee Handbook\n•\nData Protection and Privacy Policy\n•\nEqual Employment Opportunity Policy\n•\nRemote Work Guidelines\nFinal Words\nWe hope this guide gives you a comprehensive overview of what to expect at Yueniu Tech. If you \never have questions or need support, please don’t hesitate to reach out to your manager or the HR \nteam.\nWelcome aboard – we’re excited to have you with us!\nLet me know if you’d like a Google Docs link or formatted Word version as well!', '6.5 Health and Safety\nWe are dedicated to providing a safe work environment. Familiarize yourself with emergency exits, \nfirst aid kits, and safety procedures.\n7. Payroll and Benefits\nEmployees are paid monthly via direct deposit. Standard employee benefits include:\n•\nHealth insurance\n•\nPaid annual leave (minimum 20 days)\n•\nSick leave and bereavement leave\n•\nKiwiSaver contributions (for NZ-based employees)\n•\nProfessional development and training programs\n8. Performance Reviews\nPerformance reviews are conducted biannually to assess your progress, set career goals, and \nidentify training opportunities. We encourage open and constructive feedback between employees \nand managers.\n9. Career Development\nYueniu Tech supports your career growth through:\n•\nInternal job mobility\n•\nAccess to industry conferences and certifications\n•\nLeadership training and mentoring opportunities\nSpeak to your manager or HR about your career path and development goals.\n10. Company Culture and Social Events', "•\nLeadership training and mentoring opportunities\nSpeak to your manager or HR about your career path and development goals.\n10. Company Culture and Social Events\nWe believe that a happy team is a productive team. We regularly host:\n•\nTeam lunches and happy hours\n•\nHackathons and innovation days\n•\nMental health and wellness programs\n•\nMonthly recognition awards\n11. Resignation and Exit Process\nIf you choose to leave Yueniu Tech, we ask that you provide a minimum of four weeks' notice. HR \nwill guide you through the offboarding process and schedule an exit interview to gather feedback.\n12. Important Policies and Documents (Available on the \nIntranet)\nPlease take time to review the following documents, which can be accessed from the company \nintranet:\n•\nCode of Conduct\n•\nEmployee Handbook\n•\nData Protection and Privacy Policy\n•\nEqual Employment Opportunity Policy\n•\nRemote Work Guidelines\nFinal Words", '•\nHR Manager: Sarah Liu – sarah.liu@yueniutech.com\n•\nHR Generalist: Tom Zhang – tom.zhang@yueniutech.com\n•\nPhone: +64 9 123 4567\n6. Workplace Policies\n6.1 Attendance and Punctuality\nRegular attendance is essential. If you are running late or unable to attend work, please notify your \nsupervisor and HR as early as possible.\n6.2 Dress Code\nOur dress code is smart casual unless otherwise specified for meetings or events.\n6.3 IT & Security Policies\nAll employees must adhere to the company’s IT usage and cybersecurity policies. Company \nequipment must be used for professional purposes only.\n6.4 Anti-Harassment Policy\nYueniu Tech is committed to maintaining a workplace free from harassment or discrimination. Any \nconcerns will be taken seriously and addressed promptly.\n6.5 Health and Safety\nWe are dedicated to providing a safe work environment. Familiarize yourself with emergency exits, \nfirst aid kits, and safety procedures.\n7. Payroll and Benefits']
2025-07-20 21:44:09 | INFO  | __main__:run:51 | Passing documents to CrewAI for final report generation...
2025-07-20 21:44:16 | INFO  | __main__:run:58 | 
--- Final Report ---
2025-07-20 21:44:16 | INFO  | __main__:run:59 | # Yueniu Tech Leave Policy Guide

## Introduction
This document provides a comprehensive guide to understanding Yueniu Tech's leave policy. Follow the steps below to get a clear understanding of the company’s leave policies and procedures.

---

## 1. Review the Employee Handbook
The Employee Handbook, available on the company intranet, contains detailed information about the company's leave policies. It is recommended to thoroughly read this document to understand all aspects of the leave policy.

---

## 2. Check the Payroll and Benefits Section
According to the "Yueniu Tech New Employee Onboarding Handbook," under the section "Payroll and Benefits," employees are entitled to:
- **Paid annual leave** (minimum 20 days)
- **Sick leave**
- **Bereavement leave**

---

## 3. Understand the Process for Taking Leave
While the specific process for requesting leave is not detailed in the provided excerpts, it is standard practice to notify your supervisor and HR as early as possible if you are unable to attend work. This aligns with the "Attendance and Punctuality" policy mentioned in the documents.

---

## 4. Contact HR for Specific Queries
For any specific questions or clarifications regarding the leave policy, you can reach out to the HR team. The contact details are:
- **HR Manager:** Sarah Liu – sarah.liu@yueniutech.com
- **HR Generalist:** Tom Zhang – tom.zhang@yueniutech.com
- **Phone:** +64 9 123 4567

---

## 5. Additional Policies and Documents
Ensure you review other important policies and documents available on the intranet, such as the Code of Conduct, Data Protection and Privacy Policy, and Equal Employment Opportunity Policy, to get a comprehensive understanding of the company’s policies.

---

By following these steps, you will have a clear understanding of Yueniu Tech's leave policy and the process for taking leave.
2025-07-20 21:44:16 | INFO  | __main__:run:60 | --------------------

2025-07-20 21:46:49 | INFO  | __main__:run:40 | Received query: 'what's the company's leave policy?'
2025-07-20 21:46:49 | INFO  | rag.utils.milvus_manager:__init__:17 | Successfully connected to Milvus.
2025-07-20 21:46:49 | INFO  | rag.utils.milvus_manager:_create_collection_if_not_exists:28 | Collection 'rag_collection' already exists.
2025-07-20 21:46:49 | INFO  | rag.utils.retriever:retrieve:46 | Embedding query and retrieving documents for: 'what's the company's leave policy?'
2025-07-20 21:46:49 | INFO  | rag.utils.retriever:_embed_query:93 | Embedding query (real)...
2025-07-20 21:46:50 | INFO  | rag.utils.retriever:_search_milvus:116 | Searching Milvus for top 50 results...
2025-07-20 21:46:50 | INFO  | rag.utils.retriever:_rerank_documents:65 | Reranking documents...
2025-07-20 21:46:50 | ERROR | rag.utils.retriever:_rerank_documents:81 | Error reranking documents: status_code: 400, body: {'meta': {'billed_units': {'input_tokens': -1.0, 'output_tokens': -1.0}, 'tokens': {'input_tokens': -1.0, 'output_tokens': -1.0}}, 'message': 'The provided model identifier is invalid.'}
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "/private/tmp/rag-demo/rag/src/rag/main.py", line 126, in <module>
    main()
    └ <function main at 0x158819940>

  File "/private/tmp/rag-demo/rag/src/rag/main.py", line 116, in main
    run(args.query, mock=args.mock)
    │   │    │           │    └ False
    │   │    │           └ Namespace(command='run', query="what's the company's leave policy?", mock=False)
    │   │    └ "what's the company's leave policy?"
    │   └ Namespace(command='run', query="what's the company's leave policy?", mock=False)
    └ <function run at 0x1490f4180>

  File "/private/tmp/rag-demo/rag/src/rag/main.py", line 44, in run
    documents = retriever.retrieve(query)
                │         │        └ "what's the company's leave policy?"
                │         └ <function Retriever.retrieve at 0x158bd5080>
                └ <rag.utils.retriever.Retriever object at 0x159971ac0>

  File "/private/tmp/rag-demo/rag/src/rag/utils/retriever.py", line 59, in retrieve
    return self._rerank_documents(query, documents)
           │    │                 │      └ ['Yueniu Tech New Employee Onboarding \nHandbook\nWelcome to Yueniu Tech!\nWe are thrilled to have you join our team. This on...
           │    │                 └ "what's the company's leave policy?"
           │    └ <function Retriever._rerank_documents at 0x1599dda80>
           └ <rag.utils.retriever.Retriever object at 0x159971ac0>

> File "/private/tmp/rag-demo/rag/src/rag/utils/retriever.py", line 68, in _rerank_documents
    rerank_response = co.rerank(
                      │  └ <function V2Client.rerank at 0x158bd7100>
                      └ <cohere.bedrock_client.BedrockClientV2 object at 0x1599f8890>

  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/cohere/v2/client.py", line 1044, in rerank
    raise BadRequestError(
          └ <class 'cohere.errors.bad_request_error.BadRequestError'>

cohere.errors.bad_request_error.BadRequestError: status_code: 400, body: {'meta': {'billed_units': {'input_tokens': -1.0, 'output_tokens': -1.0}, 'tokens': {'input_tokens': -1.0, 'output_tokens': -1.0}}, 'message': 'The provided model identifier is invalid.'}
2025-07-20 21:46:50 | INFO  | __main__:run:45 | Documents: ['Yueniu Tech New Employee Onboarding \nHandbook\nWelcome to Yueniu Tech!\nWe are thrilled to have you join our team. This onboarding handbook is designed to help you \nnavigate your first days, understand our values, policies, and expectations, and ensure a smooth \ntransition into your new role.\n1. About Yueniu Tech\nFounded with the mission to innovate and empower, Yueniu Tech is a technology-driven company \nthat values excellence, creativity, and collaboration. We strive to provide cutting-edge solutions to \nour clients while fostering a dynamic and inclusive workplace.\n2. Company Values\n•\nInnovation: We embrace new ideas and technologies.\n•\nIntegrity: We conduct our business with the highest ethical standards.\n•\nCollaboration: Teamwork is at the heart of our operations.\n•\nCustomer Focus: We prioritize the needs and satisfaction of our clients.\n•\nContinuous Improvement: We are committed to personal and professional growth.\n3. Your First Day', 'intranet:\n•\nCode of Conduct\n•\nEmployee Handbook\n•\nData Protection and Privacy Policy\n•\nEqual Employment Opportunity Policy\n•\nRemote Work Guidelines\nFinal Words\nWe hope this guide gives you a comprehensive overview of what to expect at Yueniu Tech. If you \never have questions or need support, please don’t hesitate to reach out to your manager or the HR \nteam.\nWelcome aboard – we’re excited to have you with us!\nLet me know if you’d like a Google Docs link or formatted Word version as well!', '6.5 Health and Safety\nWe are dedicated to providing a safe work environment. Familiarize yourself with emergency exits, \nfirst aid kits, and safety procedures.\n7. Payroll and Benefits\nEmployees are paid monthly via direct deposit. Standard employee benefits include:\n•\nHealth insurance\n•\nPaid annual leave (minimum 20 days)\n•\nSick leave and bereavement leave\n•\nKiwiSaver contributions (for NZ-based employees)\n•\nProfessional development and training programs\n8. Performance Reviews\nPerformance reviews are conducted biannually to assess your progress, set career goals, and \nidentify training opportunities. We encourage open and constructive feedback between employees \nand managers.\n9. Career Development\nYueniu Tech supports your career growth through:\n•\nInternal job mobility\n•\nAccess to industry conferences and certifications\n•\nLeadership training and mentoring opportunities\nSpeak to your manager or HR about your career path and development goals.\n10. Company Culture and Social Events', "•\nLeadership training and mentoring opportunities\nSpeak to your manager or HR about your career path and development goals.\n10. Company Culture and Social Events\nWe believe that a happy team is a productive team. We regularly host:\n•\nTeam lunches and happy hours\n•\nHackathons and innovation days\n•\nMental health and wellness programs\n•\nMonthly recognition awards\n11. Resignation and Exit Process\nIf you choose to leave Yueniu Tech, we ask that you provide a minimum of four weeks' notice. HR \nwill guide you through the offboarding process and schedule an exit interview to gather feedback.\n12. Important Policies and Documents (Available on the \nIntranet)\nPlease take time to review the following documents, which can be accessed from the company \nintranet:\n•\nCode of Conduct\n•\nEmployee Handbook\n•\nData Protection and Privacy Policy\n•\nEqual Employment Opportunity Policy\n•\nRemote Work Guidelines\nFinal Words", '•\nHR Manager: Sarah Liu – sarah.liu@yueniutech.com\n•\nHR Generalist: Tom Zhang – tom.zhang@yueniutech.com\n•\nPhone: +64 9 123 4567\n6. Workplace Policies\n6.1 Attendance and Punctuality\nRegular attendance is essential. If you are running late or unable to attend work, please notify your \nsupervisor and HR as early as possible.\n6.2 Dress Code\nOur dress code is smart casual unless otherwise specified for meetings or events.\n6.3 IT & Security Policies\nAll employees must adhere to the company’s IT usage and cybersecurity policies. Company \nequipment must be used for professional purposes only.\n6.4 Anti-Harassment Policy\nYueniu Tech is committed to maintaining a workplace free from harassment or discrimination. Any \nconcerns will be taken seriously and addressed promptly.\n6.5 Health and Safety\nWe are dedicated to providing a safe work environment. Familiarize yourself with emergency exits, \nfirst aid kits, and safety procedures.\n7. Payroll and Benefits']
2025-07-20 21:46:50 | INFO  | __main__:run:51 | Passing documents to CrewAI for final report generation...
2025-07-20 21:46:57 | INFO  | __main__:run:58 | 
--- Final Report ---
2025-07-20 21:46:57 | INFO  | __main__:run:59 | # Yueniu Tech Leave Policy

## Overview
This report outlines Yueniu Tech's leave policy to ensure employees understand their entitlements and the process for requesting leave.

## Review the Employee Handbook
- **Action**: Thoroughly read the Employee Handbook available on the company intranet.
- **Purpose**: To understand all aspects of the leave policy.

## Types of Leave
### Paid Annual Leave
- **Entitlement**: Minimum of 20 days per year.

### Sick Leave
- **Entitlement**: Provided for when employees are unwell.

### Bereavement Leave
- **Entitlement**: Available in the event of a family member’s death.

## Requesting Leave
- **Notification**: Notify your supervisor and HR as early as possible.
- **Form**: Use the company’s official leave request form, available on the intranet or provided by your manager.

## Approval Process
- **Review**: Leave requests are subject to approval by your direct supervisor and HR.
- **Follow-Up**: Ensure you follow up to confirm your request has been received and is being processed.

## Documentation
- **Record Keeping**: Keep a record of your leave requests and approvals for personal records.
- **Purpose**: To track your leave balance and ensure awareness of your entitlements.

## Returning from Leave
- **Notification**: Inform your supervisor and HR of your return date upon returning from leave.
- **Purpose**: To facilitate a smooth transition back into work.

## Contact HR for Assistance
- If you have any questions or need further clarification on the leave policy, reach out to the HR team.

### HR Contacts
- **HR Manager**: Sarah Liu – sarah.liu@yueniutech.com
- **HR Generalist**: Tom Zhang – tom.zhang@yueniutech.com
- **Phone**: +64 9 123 4567

---

By following these steps, you can effectively manage your leave at Yueniu Tech.
2025-07-20 21:46:57 | INFO  | __main__:run:60 | --------------------

2025-07-20 21:55:43 | INFO  | __main__:run:40 | Received query: 'what's the company's leave policy?'
2025-07-20 21:56:04 | ERROR | rag.utils.milvus_manager:__init__:20 | Error connecting to Milvus. Please ensure Milvus is running. Details: <MilvusException: (code=2, message=Fail connecting to server on 127.0.0.1:19530, illegal connection params or server unavailable)>
Traceback (most recent call last):

  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/pymilvus/client/grpc_handler.py", line 150, in _wait_for_channel_ready
    grpc.channel_ready_future(self._channel).result(timeout=timeout)
    │    │                    │    │                        └ 10.0
    │    │                    │    └ None
    │    │                    └ <pymilvus.client.grpc_handler.GrpcHandler object at 0x145f00c20>
    │    └ <function channel_ready_future at 0x116566020>
    └ <module 'grpc' from '/Users/jadoreran/miniconda3/lib/python3.12/site-packages/grpc/__init__.py'>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/grpc/_utilities.py", line 162, in result
    self._block(timeout)
    │    │      └ 10.0
    │    └ <function _ChannelReadyFuture._block at 0x1178b3600>
    └ <grpc._utilities._ChannelReadyFuture object at 0x145b9d220>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/grpc/_utilities.py", line 106, in _block
    raise grpc.FutureTimeoutError()
          │    └ <class 'grpc.FutureTimeoutError'>
          └ <module 'grpc' from '/Users/jadoreran/miniconda3/lib/python3.12/site-packages/grpc/__init__.py'>

grpc.FutureTimeoutError


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "/private/tmp/rag-demo/rag/src/rag/main.py", line 126, in <module>
    main()
    └ <function main at 0x144d09d00>

  File "/private/tmp/rag-demo/rag/src/rag/main.py", line 116, in main
    run(args.query, mock=args.mock)
    │   │    │           │    └ False
    │   │    │           └ Namespace(command='run', query="what's the company's leave policy?", mock=False)
    │   │    └ "what's the company's leave policy?"
    │   └ Namespace(command='run', query="what's the company's leave policy?", mock=False)
    └ <function run at 0x135c04220>

  File "/private/tmp/rag-demo/rag/src/rag/main.py", line 42, in run
    milvus_manager = MilvusManager()
                     └ <class 'rag.utils.milvus_manager.MilvusManager'>

> File "/private/tmp/rag-demo/rag/src/rag/utils/milvus_manager.py", line 16, in __init__
    connections.connect("default", host=host, port=port)
    │           │                       │          └ '19530'
    │           │                       └ '127.0.0.1'
    │           └ <function Connections.connect at 0x144cbeca0>
    └ <pymilvus.orm.connections.Connections object at 0x144cc0440>

  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/pymilvus/orm/connections.py", line 461, in connect
    connect_milvus(**kwargs, user=user, password=password, token=token, db_name=db_name)
    │                │            │              │               │              └ 'default'
    │                │            │              │               └ ''
    │                │            │              └ ''
    │                │            └ ''
    │                └ {'address': '127.0.0.1:19530'}
    └ <function Connections.connect.<locals>.connect_milvus at 0x145deff60>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/pymilvus/orm/connections.py", line 411, in connect_milvus
    gh._wait_for_channel_ready(timeout=timeout)
    │  │                               └ 10.0
    │  └ <function GrpcHandler._wait_for_channel_ready at 0x144c84900>
    └ <pymilvus.client.grpc_handler.GrpcHandler object at 0x145f00c20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/pymilvus/client/grpc_handler.py", line 154, in _wait_for_channel_ready
    raise MilvusException(
          └ <class 'pymilvus.exceptions.MilvusException'>

pymilvus.exceptions.MilvusException: <MilvusException: (code=2, message=Fail connecting to server on 127.0.0.1:19530, illegal connection params or server unavailable)>
2025-07-20 21:56:04 | ERROR | __main__:run:63 | An error occurred while running the query: <MilvusException: (code=2, message=Fail connecting to server on 127.0.0.1:19530, illegal connection params or server unavailable)>
Traceback (most recent call last):

  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/pymilvus/client/grpc_handler.py", line 150, in _wait_for_channel_ready
    grpc.channel_ready_future(self._channel).result(timeout=timeout)
    │    │                    │    │                        └ 10.0
    │    │                    │    └ None
    │    │                    └ <pymilvus.client.grpc_handler.GrpcHandler object at 0x145f00c20>
    │    └ <function channel_ready_future at 0x116566020>
    └ <module 'grpc' from '/Users/jadoreran/miniconda3/lib/python3.12/site-packages/grpc/__init__.py'>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/grpc/_utilities.py", line 162, in result
    self._block(timeout)
    │    │      └ 10.0
    │    └ <function _ChannelReadyFuture._block at 0x1178b3600>
    └ <grpc._utilities._ChannelReadyFuture object at 0x145b9d220>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/grpc/_utilities.py", line 106, in _block
    raise grpc.FutureTimeoutError()
          │    └ <class 'grpc.FutureTimeoutError'>
          └ <module 'grpc' from '/Users/jadoreran/miniconda3/lib/python3.12/site-packages/grpc/__init__.py'>

grpc.FutureTimeoutError


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "/private/tmp/rag-demo/rag/src/rag/main.py", line 126, in <module>
    main()
    └ <function main at 0x144d09d00>

  File "/private/tmp/rag-demo/rag/src/rag/main.py", line 116, in main
    run(args.query, mock=args.mock)
    │   │    │           │    └ False
    │   │    │           └ Namespace(command='run', query="what's the company's leave policy?", mock=False)
    │   │    └ "what's the company's leave policy?"
    │   └ Namespace(command='run', query="what's the company's leave policy?", mock=False)
    └ <function run at 0x135c04220>

> File "/private/tmp/rag-demo/rag/src/rag/main.py", line 42, in run
    milvus_manager = MilvusManager()
                     └ <class 'rag.utils.milvus_manager.MilvusManager'>

  File "/private/tmp/rag-demo/rag/src/rag/utils/milvus_manager.py", line 16, in __init__
    connections.connect("default", host=host, port=port)
    │           │                       │          └ '19530'
    │           │                       └ '127.0.0.1'
    │           └ <function Connections.connect at 0x144cbeca0>
    └ <pymilvus.orm.connections.Connections object at 0x144cc0440>

  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/pymilvus/orm/connections.py", line 461, in connect
    connect_milvus(**kwargs, user=user, password=password, token=token, db_name=db_name)
    │                │            │              │               │              └ 'default'
    │                │            │              │               └ ''
    │                │            │              └ ''
    │                │            └ ''
    │                └ {'address': '127.0.0.1:19530'}
    └ <function Connections.connect.<locals>.connect_milvus at 0x145deff60>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/pymilvus/orm/connections.py", line 411, in connect_milvus
    gh._wait_for_channel_ready(timeout=timeout)
    │  │                               └ 10.0
    │  └ <function GrpcHandler._wait_for_channel_ready at 0x144c84900>
    └ <pymilvus.client.grpc_handler.GrpcHandler object at 0x145f00c20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/pymilvus/client/grpc_handler.py", line 154, in _wait_for_channel_ready
    raise MilvusException(
          └ <class 'pymilvus.exceptions.MilvusException'>

pymilvus.exceptions.MilvusException: <MilvusException: (code=2, message=Fail connecting to server on 127.0.0.1:19530, illegal connection params or server unavailable)>
2025-07-20 21:58:30 | INFO  | __main__:run:40 | Received query: 'what's the company's leave policy?'
2025-07-20 21:58:30 | INFO  | rag.utils.milvus_manager:__init__:17 | Successfully connected to Milvus.
2025-07-20 21:58:30 | INFO  | rag.utils.milvus_manager:_create_collection_if_not_exists:28 | Collection 'rag_collection' already exists.
2025-07-20 21:58:30 | INFO  | rag.utils.retriever:retrieve:47 | Embedding query and retrieving documents for: 'what's the company's leave policy?'
2025-07-20 21:58:30 | INFO  | rag.utils.retriever:_embed_query:94 | Embedding query (real)...
2025-07-20 21:58:31 | INFO  | rag.utils.retriever:_search_milvus:117 | Searching Milvus for top 50 results...
2025-07-20 21:58:31 | INFO  | rag.utils.retriever:_rerank_documents:66 | Reranking documents...
2025-07-20 21:58:32 | ERROR | rag.utils.retriever:_rerank_documents:82 | Error reranking documents: status_code: 400, body: {'meta': {'billed_units': {'input_tokens': -1.0, 'output_tokens': -1.0}, 'tokens': {'input_tokens': -1.0, 'output_tokens': -1.0}}, 'message': 'The provided model identifier is invalid.'}
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "/private/tmp/rag-demo/rag/src/rag/main.py", line 126, in <module>
    main()
    └ <function main at 0x165419a80>

  File "/private/tmp/rag-demo/rag/src/rag/main.py", line 116, in main
    run(args.query, mock=args.mock)
    │   │    │           │    └ False
    │   │    │           └ Namespace(command='run', query="what's the company's leave policy?", mock=False)
    │   │    └ "what's the company's leave policy?"
    │   └ Namespace(command='run', query="what's the company's leave policy?", mock=False)
    └ <function run at 0x1458f0180>

  File "/private/tmp/rag-demo/rag/src/rag/main.py", line 44, in run
    documents = retriever.retrieve(query)
                │         │        └ "what's the company's leave policy?"
                │         └ <function Retriever.retrieve at 0x1656d5c60>
                └ <rag.utils.retriever.Retriever object at 0x165bd6ba0>

  File "/private/tmp/rag-demo/rag/src/rag/utils/retriever.py", line 60, in retrieve
    return self._rerank_documents(query, documents)
           │    │                 │      └ ['Yueniu Tech New Employee Onboarding \nHandbook\nWelcome to Yueniu Tech!\nWe are thrilled to have you join our team. This on...
           │    │                 └ "what's the company's leave policy?"
           │    └ <function Retriever._rerank_documents at 0x165bddbc0>
           └ <rag.utils.retriever.Retriever object at 0x165bd6ba0>

> File "/private/tmp/rag-demo/rag/src/rag/utils/retriever.py", line 69, in _rerank_documents
    rerank_response = co.rerank(
                      │  └ <function V2Client.rerank at 0x1656d6fc0>
                      └ <cohere.bedrock_client.BedrockClientV2 object at 0x16d29e7e0>

  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/cohere/v2/client.py", line 1044, in rerank
    raise BadRequestError(
          └ <class 'cohere.errors.bad_request_error.BadRequestError'>

cohere.errors.bad_request_error.BadRequestError: status_code: 400, body: {'meta': {'billed_units': {'input_tokens': -1.0, 'output_tokens': -1.0}, 'tokens': {'input_tokens': -1.0, 'output_tokens': -1.0}}, 'message': 'The provided model identifier is invalid.'}
2025-07-20 21:58:32 | INFO  | __main__:run:45 | Documents: ['Yueniu Tech New Employee Onboarding \nHandbook\nWelcome to Yueniu Tech!\nWe are thrilled to have you join our team. This onboarding handbook is designed to help you \nnavigate your first days, understand our values, policies, and expectations, and ensure a smooth \ntransition into your new role.\n1. About Yueniu Tech\nFounded with the mission to innovate and empower, Yueniu Tech is a technology-driven company \nthat values excellence, creativity, and collaboration. We strive to provide cutting-edge solutions to \nour clients while fostering a dynamic and inclusive workplace.\n2. Company Values\n•\nInnovation: We embrace new ideas and technologies.\n•\nIntegrity: We conduct our business with the highest ethical standards.\n•\nCollaboration: Teamwork is at the heart of our operations.\n•\nCustomer Focus: We prioritize the needs and satisfaction of our clients.\n•\nContinuous Improvement: We are committed to personal and professional growth.\n3. Your First Day', 'intranet:\n•\nCode of Conduct\n•\nEmployee Handbook\n•\nData Protection and Privacy Policy\n•\nEqual Employment Opportunity Policy\n•\nRemote Work Guidelines\nFinal Words\nWe hope this guide gives you a comprehensive overview of what to expect at Yueniu Tech. If you \never have questions or need support, please don’t hesitate to reach out to your manager or the HR \nteam.\nWelcome aboard – we’re excited to have you with us!\nLet me know if you’d like a Google Docs link or formatted Word version as well!', '6.5 Health and Safety\nWe are dedicated to providing a safe work environment. Familiarize yourself with emergency exits, \nfirst aid kits, and safety procedures.\n7. Payroll and Benefits\nEmployees are paid monthly via direct deposit. Standard employee benefits include:\n•\nHealth insurance\n•\nPaid annual leave (minimum 20 days)\n•\nSick leave and bereavement leave\n•\nKiwiSaver contributions (for NZ-based employees)\n•\nProfessional development and training programs\n8. Performance Reviews\nPerformance reviews are conducted biannually to assess your progress, set career goals, and \nidentify training opportunities. We encourage open and constructive feedback between employees \nand managers.\n9. Career Development\nYueniu Tech supports your career growth through:\n•\nInternal job mobility\n•\nAccess to industry conferences and certifications\n•\nLeadership training and mentoring opportunities\nSpeak to your manager or HR about your career path and development goals.\n10. Company Culture and Social Events', "•\nLeadership training and mentoring opportunities\nSpeak to your manager or HR about your career path and development goals.\n10. Company Culture and Social Events\nWe believe that a happy team is a productive team. We regularly host:\n•\nTeam lunches and happy hours\n•\nHackathons and innovation days\n•\nMental health and wellness programs\n•\nMonthly recognition awards\n11. Resignation and Exit Process\nIf you choose to leave Yueniu Tech, we ask that you provide a minimum of four weeks' notice. HR \nwill guide you through the offboarding process and schedule an exit interview to gather feedback.\n12. Important Policies and Documents (Available on the \nIntranet)\nPlease take time to review the following documents, which can be accessed from the company \nintranet:\n•\nCode of Conduct\n•\nEmployee Handbook\n•\nData Protection and Privacy Policy\n•\nEqual Employment Opportunity Policy\n•\nRemote Work Guidelines\nFinal Words", '•\nHR Manager: Sarah Liu – sarah.liu@yueniutech.com\n•\nHR Generalist: Tom Zhang – tom.zhang@yueniutech.com\n•\nPhone: +64 9 123 4567\n6. Workplace Policies\n6.1 Attendance and Punctuality\nRegular attendance is essential. If you are running late or unable to attend work, please notify your \nsupervisor and HR as early as possible.\n6.2 Dress Code\nOur dress code is smart casual unless otherwise specified for meetings or events.\n6.3 IT & Security Policies\nAll employees must adhere to the company’s IT usage and cybersecurity policies. Company \nequipment must be used for professional purposes only.\n6.4 Anti-Harassment Policy\nYueniu Tech is committed to maintaining a workplace free from harassment or discrimination. Any \nconcerns will be taken seriously and addressed promptly.\n6.5 Health and Safety\nWe are dedicated to providing a safe work environment. Familiarize yourself with emergency exits, \nfirst aid kits, and safety procedures.\n7. Payroll and Benefits']
2025-07-20 21:58:32 | INFO  | __main__:run:51 | Passing documents to CrewAI for final report generation...
2025-07-20 21:58:38 | INFO  | __main__:run:58 | 
--- Final Report ---
2025-07-20 21:58:38 | INFO  | __main__:run:59 | # Yueniu Tech Leave Policy Guide

## Introduction
This guide provides a comprehensive overview of Yueniu Tech's leave policy, including the types of leave available, the process for requesting leave, and important contacts for further assistance.

## 1. Review the Employee Handbook
The Employee Handbook contains detailed information about the company's leave policies. You can access this document via the company intranet.

## 2. Understand the Types of Leave
Yueniu Tech offers several types of leave to support employees' well-being and personal needs:

- **Paid Annual Leave**: Employees are entitled to a minimum of 20 days of paid annual leave.
- **Sick Leave**: Employees are provided with sick leave for when they are unwell.
- **Bereavement Leave**: Employees can take bereavement leave in the event of a family member’s death.

## 3. Requesting Leave
To request leave, follow these steps:

1. Notify your supervisor and the HR department as early as possible.
2. Use the company’s leave request form, which can typically be found on the intranet or provided by your HR contact.

## 4. Approval Process
Your leave request will be reviewed by your supervisor and HR. Once approved, you will receive confirmation via email or the company’s internal communication system.

## 5. During Your Leave
While on leave, ensure you are unavailable for work unless otherwise specified. If your leave duration changes, inform your supervisor and HR immediately.

## 6. Returning to Work
Notify your supervisor and HR of your return date. If required, provide any necessary documentation (e.g., medical certificates for sick leave).

## 7. Additional Resources
For any questions or further clarification, contact the HR team:

- **HR Manager**: Sarah Liu – sarah.liu@yueniutech.com
- **HR Generalist**: Tom Zhang – tom.zhang@yueniutech.com
- **Phone**: +64 9 123 4567

## 8. Review Important Policies
Ensure you are familiar with other important policies available on the intranet, such as the Code of Conduct, Data Protection and Privacy Policy, and Equal Employment Opportunity Policy.

---

By following these steps, you will have a comprehensive understanding of Yueniu Tech's leave policy and the process for requesting and managing your leave.
2025-07-20 21:58:38 | INFO  | __main__:run:60 | --------------------

2025-07-20 21:58:50 | INFO  | __main__:run:40 | Received query: 'what's the company's leave policy?'
2025-07-20 21:58:50 | INFO  | rag.utils.milvus_manager:__init__:17 | Successfully connected to Milvus.
2025-07-20 21:58:50 | INFO  | rag.utils.milvus_manager:_create_collection_if_not_exists:28 | Collection 'rag_collection' already exists.
2025-07-20 21:58:50 | INFO  | rag.utils.retriever:retrieve:47 | Embedding query and retrieving documents for: 'what's the company's leave policy?'
2025-07-20 21:58:50 | INFO  | rag.utils.retriever:_embed_query:94 | Embedding query (real)...
2025-07-20 21:58:51 | INFO  | rag.utils.retriever:_search_milvus:117 | Searching Milvus for top 50 results...
2025-07-20 21:58:51 | INFO  | rag.utils.retriever:_rerank_documents:66 | Reranking documents...
2025-07-20 21:58:51 | ERROR | rag.utils.retriever:_rerank_documents:82 | Error reranking documents: status_code: 400, body: {'meta': {'billed_units': {'input_tokens': -1.0, 'output_tokens': -1.0}, 'tokens': {'input_tokens': -1.0, 'output_tokens': -1.0}}, 'message': 'The provided model identifier is invalid.'}
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "/private/tmp/rag-demo/rag/src/rag/main.py", line 126, in <module>
    main()
    └ <function main at 0x169219a80>

  File "/private/tmp/rag-demo/rag/src/rag/main.py", line 116, in main
    run(args.query, mock=args.mock)
    │   │    │           │    └ False
    │   │    │           └ Namespace(command='run', query="what's the company's leave policy?", mock=False)
    │   │    └ "what's the company's leave policy?"
    │   └ Namespace(command='run', query="what's the company's leave policy?", mock=False)
    └ <function run at 0x16338c180>

  File "/private/tmp/rag-demo/rag/src/rag/main.py", line 44, in run
    documents = retriever.retrieve(query)
                │         │        └ "what's the company's leave policy?"
                │         └ <function Retriever.retrieve at 0x1694d1c60>
                └ <rag.utils.retriever.Retriever object at 0x16a0e21b0>

  File "/private/tmp/rag-demo/rag/src/rag/utils/retriever.py", line 60, in retrieve
    return self._rerank_documents(query, documents)
           │    │                 │      └ ['Yueniu Tech New Employee Onboarding \nHandbook\nWelcome to Yueniu Tech!\nWe are thrilled to have you join our team. This on...
           │    │                 └ "what's the company's leave policy?"
           │    └ <function Retriever._rerank_documents at 0x16a2ddbc0>
           └ <rag.utils.retriever.Retriever object at 0x16a0e21b0>

> File "/private/tmp/rag-demo/rag/src/rag/utils/retriever.py", line 69, in _rerank_documents
    rerank_response = co.rerank(
                      │  └ <function V2Client.rerank at 0x1694d2fc0>
                      └ <cohere.bedrock_client.BedrockClientV2 object at 0x16a464a40>

  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/cohere/v2/client.py", line 1044, in rerank
    raise BadRequestError(
          └ <class 'cohere.errors.bad_request_error.BadRequestError'>

cohere.errors.bad_request_error.BadRequestError: status_code: 400, body: {'meta': {'billed_units': {'input_tokens': -1.0, 'output_tokens': -1.0}, 'tokens': {'input_tokens': -1.0, 'output_tokens': -1.0}}, 'message': 'The provided model identifier is invalid.'}
2025-07-20 21:58:51 | INFO  | __main__:run:45 | Documents: ['Yueniu Tech New Employee Onboarding \nHandbook\nWelcome to Yueniu Tech!\nWe are thrilled to have you join our team. This onboarding handbook is designed to help you \nnavigate your first days, understand our values, policies, and expectations, and ensure a smooth \ntransition into your new role.\n1. About Yueniu Tech\nFounded with the mission to innovate and empower, Yueniu Tech is a technology-driven company \nthat values excellence, creativity, and collaboration. We strive to provide cutting-edge solutions to \nour clients while fostering a dynamic and inclusive workplace.\n2. Company Values\n•\nInnovation: We embrace new ideas and technologies.\n•\nIntegrity: We conduct our business with the highest ethical standards.\n•\nCollaboration: Teamwork is at the heart of our operations.\n•\nCustomer Focus: We prioritize the needs and satisfaction of our clients.\n•\nContinuous Improvement: We are committed to personal and professional growth.\n3. Your First Day', 'intranet:\n•\nCode of Conduct\n•\nEmployee Handbook\n•\nData Protection and Privacy Policy\n•\nEqual Employment Opportunity Policy\n•\nRemote Work Guidelines\nFinal Words\nWe hope this guide gives you a comprehensive overview of what to expect at Yueniu Tech. If you \never have questions or need support, please don’t hesitate to reach out to your manager or the HR \nteam.\nWelcome aboard – we’re excited to have you with us!\nLet me know if you’d like a Google Docs link or formatted Word version as well!', '6.5 Health and Safety\nWe are dedicated to providing a safe work environment. Familiarize yourself with emergency exits, \nfirst aid kits, and safety procedures.\n7. Payroll and Benefits\nEmployees are paid monthly via direct deposit. Standard employee benefits include:\n•\nHealth insurance\n•\nPaid annual leave (minimum 20 days)\n•\nSick leave and bereavement leave\n•\nKiwiSaver contributions (for NZ-based employees)\n•\nProfessional development and training programs\n8. Performance Reviews\nPerformance reviews are conducted biannually to assess your progress, set career goals, and \nidentify training opportunities. We encourage open and constructive feedback between employees \nand managers.\n9. Career Development\nYueniu Tech supports your career growth through:\n•\nInternal job mobility\n•\nAccess to industry conferences and certifications\n•\nLeadership training and mentoring opportunities\nSpeak to your manager or HR about your career path and development goals.\n10. Company Culture and Social Events', "•\nLeadership training and mentoring opportunities\nSpeak to your manager or HR about your career path and development goals.\n10. Company Culture and Social Events\nWe believe that a happy team is a productive team. We regularly host:\n•\nTeam lunches and happy hours\n•\nHackathons and innovation days\n•\nMental health and wellness programs\n•\nMonthly recognition awards\n11. Resignation and Exit Process\nIf you choose to leave Yueniu Tech, we ask that you provide a minimum of four weeks' notice. HR \nwill guide you through the offboarding process and schedule an exit interview to gather feedback.\n12. Important Policies and Documents (Available on the \nIntranet)\nPlease take time to review the following documents, which can be accessed from the company \nintranet:\n•\nCode of Conduct\n•\nEmployee Handbook\n•\nData Protection and Privacy Policy\n•\nEqual Employment Opportunity Policy\n•\nRemote Work Guidelines\nFinal Words", '•\nHR Manager: Sarah Liu – sarah.liu@yueniutech.com\n•\nHR Generalist: Tom Zhang – tom.zhang@yueniutech.com\n•\nPhone: +64 9 123 4567\n6. Workplace Policies\n6.1 Attendance and Punctuality\nRegular attendance is essential. If you are running late or unable to attend work, please notify your \nsupervisor and HR as early as possible.\n6.2 Dress Code\nOur dress code is smart casual unless otherwise specified for meetings or events.\n6.3 IT & Security Policies\nAll employees must adhere to the company’s IT usage and cybersecurity policies. Company \nequipment must be used for professional purposes only.\n6.4 Anti-Harassment Policy\nYueniu Tech is committed to maintaining a workplace free from harassment or discrimination. Any \nconcerns will be taken seriously and addressed promptly.\n6.5 Health and Safety\nWe are dedicated to providing a safe work environment. Familiarize yourself with emergency exits, \nfirst aid kits, and safety procedures.\n7. Payroll and Benefits']
2025-07-20 21:58:51 | INFO  | __main__:run:51 | Passing documents to CrewAI for final report generation...
2025-07-20 21:58:58 | INFO  | __main__:run:58 | 
--- Final Report ---
2025-07-20 21:58:58 | INFO  | __main__:run:59 | # Yueniu Tech Leave Policy Guide

## Introduction
This guide provides a comprehensive overview of Yueniu Tech's leave policy. Follow these steps to understand your entitlements and the procedures for taking leave.

## 1. Review the Employee Handbook
- The **Employee Handbook** is available on the company intranet and contains detailed information about the leave policy. It is recommended to thoroughly read this document for comprehensive details.

## 2. Understand the Types of Leave
Yueniu Tech offers several types of leave to accommodate different needs:

### **Paid Annual Leave**
- Employees are entitled to a minimum of **20 days** of paid annual leave.

### **Sick Leave**
- Employees are provided with sick leave to accommodate health-related absences.

### **Bereavement Leave**
- Specific leave is available for employees dealing with the loss of a family member.

## 3. Check the Payroll and Benefits Section
In the onboarding handbook under the "Payroll and Benefits" section, you will find:
- Health insurance
- Paid annual leave (minimum 20 days)
- Sick leave and bereavement leave
- KiwiSaver contributions (for NZ-based employees)
- Professional development and training programs

## 4. Notify Your Supervisor and HR
If you need to take leave, it is essential to notify your supervisor and the HR department as early as possible. This ensures that your absence is properly recorded and managed.

## 5. Access Important Policies and Documents
Additional policies and documents related to leave can be found on the company intranet. These include:
- Code of Conduct
- Employee Handbook
- Data Protection and Privacy Policy
- Equal Employment Opportunity Policy
- Remote Work Guidelines

## 6. Contact HR for Further Assistance
If you have any questions or need further clarification on the leave policy, you can reach out to the HR team:

- **HR Manager**: Sarah Liu – [sarah.liu@yueniutech.com](mailto:sarah.liu@yueniutech.com)
- **HR Generalist**: Tom Zhang – [tom.zhang@yueniutech.com](mailto:tom.zhang@yueniutech.com)
- **Phone**: +64 9 123 4567

By following these steps, you will have a clear understanding of Yueniu Tech's leave policy and the procedures for taking leave.

---

**Image:** A chart showing Q3 sales. (Path: /path/to/image.png)

---
2025-07-20 21:58:58 | INFO  | __main__:run:60 | --------------------

2025-07-20 22:02:17 | INFO  | __main__:run:40 | Received query: 'what's the company's leave policy?'
2025-07-20 22:02:17 | INFO  | rag.utils.milvus_manager:__init__:17 | Successfully connected to Milvus.
2025-07-20 22:02:17 | INFO  | rag.utils.milvus_manager:_create_collection_if_not_exists:28 | Collection 'rag_collection' already exists.
2025-07-20 22:02:18 | INFO  | rag.utils.retriever:retrieve:46 | Embedding query and retrieving documents for: 'what's the company's leave policy?'
2025-07-20 22:02:18 | INFO  | rag.utils.retriever:_embed_query:93 | Embedding query (real)...
2025-07-20 22:02:18 | INFO  | rag.utils.retriever:_search_milvus:116 | Searching Milvus for top 50 results...
2025-07-20 22:02:18 | INFO  | rag.utils.retriever:_rerank_documents:65 | Reranking documents...
2025-07-20 22:02:19 | INFO  | rag.utils.retriever:_rerank_documents:78 | Reranked 5 documents.
2025-07-20 22:02:19 | INFO  | __main__:run:45 | Documents: ["•\nLeadership training and mentoring opportunities\nSpeak to your manager or HR about your career path and development goals.\n10. Company Culture and Social Events\nWe believe that a happy team is a productive team. We regularly host:\n•\nTeam lunches and happy hours\n•\nHackathons and innovation days\n•\nMental health and wellness programs\n•\nMonthly recognition awards\n11. Resignation and Exit Process\nIf you choose to leave Yueniu Tech, we ask that you provide a minimum of four weeks' notice. HR \nwill guide you through the offboarding process and schedule an exit interview to gather feedback.\n12. Important Policies and Documents (Available on the \nIntranet)\nPlease take time to review the following documents, which can be accessed from the company \nintranet:\n•\nCode of Conduct\n•\nEmployee Handbook\n•\nData Protection and Privacy Policy\n•\nEqual Employment Opportunity Policy\n•\nRemote Work Guidelines\nFinal Words", '6.5 Health and Safety\nWe are dedicated to providing a safe work environment. Familiarize yourself with emergency exits, \nfirst aid kits, and safety procedures.\n7. Payroll and Benefits\nEmployees are paid monthly via direct deposit. Standard employee benefits include:\n•\nHealth insurance\n•\nPaid annual leave (minimum 20 days)\n•\nSick leave and bereavement leave\n•\nKiwiSaver contributions (for NZ-based employees)\n•\nProfessional development and training programs\n8. Performance Reviews\nPerformance reviews are conducted biannually to assess your progress, set career goals, and \nidentify training opportunities. We encourage open and constructive feedback between employees \nand managers.\n9. Career Development\nYueniu Tech supports your career growth through:\n•\nInternal job mobility\n•\nAccess to industry conferences and certifications\n•\nLeadership training and mentoring opportunities\nSpeak to your manager or HR about your career path and development goals.\n10. Company Culture and Social Events', '•\nHR Manager: Sarah Liu – sarah.liu@yueniutech.com\n•\nHR Generalist: Tom Zhang – tom.zhang@yueniutech.com\n•\nPhone: +64 9 123 4567\n6. Workplace Policies\n6.1 Attendance and Punctuality\nRegular attendance is essential. If you are running late or unable to attend work, please notify your \nsupervisor and HR as early as possible.\n6.2 Dress Code\nOur dress code is smart casual unless otherwise specified for meetings or events.\n6.3 IT & Security Policies\nAll employees must adhere to the company’s IT usage and cybersecurity policies. Company \nequipment must be used for professional purposes only.\n6.4 Anti-Harassment Policy\nYueniu Tech is committed to maintaining a workplace free from harassment or discrimination. Any \nconcerns will be taken seriously and addressed promptly.\n6.5 Health and Safety\nWe are dedicated to providing a safe work environment. Familiarize yourself with emergency exits, \nfirst aid kits, and safety procedures.\n7. Payroll and Benefits', '•\nCustomer Focus: We prioritize the needs and satisfaction of our clients.\n•\nContinuous Improvement: We are committed to personal and professional growth.\n3. Your First Day\nOn your first day, please arrive at the reception by 9:00 AM. You will be greeted by our HR \nrepresentative, who will give you a tour of the office and introduce you to your team. Your \nworkstation will be set up, and you’ll receive your ID badge and necessary equipment.\n4. Required Documents\nPlease bring the following documents on your first day:\n•\nValid government-issued ID\n•\nBank account details for payroll setup\n•\nSigned offer letter and employment contract\n•\nCompleted tax forms (IR330 for New Zealand employees)\n•\nWork visa (if applicable)\n5. HR Contacts\nIf you have any questions or concerns, our HR team is here to help:\n•\nHR Manager: Sarah Liu – sarah.liu@yueniutech.com\n•\nHR Generalist: Tom Zhang – tom.zhang@yueniutech.com\n•\nPhone: +64 9 123 4567\n6. Workplace Policies\n6.1 Attendance and Punctuality', 'intranet:\n•\nCode of Conduct\n•\nEmployee Handbook\n•\nData Protection and Privacy Policy\n•\nEqual Employment Opportunity Policy\n•\nRemote Work Guidelines\nFinal Words\nWe hope this guide gives you a comprehensive overview of what to expect at Yueniu Tech. If you \never have questions or need support, please don’t hesitate to reach out to your manager or the HR \nteam.\nWelcome aboard – we’re excited to have you with us!\nLet me know if you’d like a Google Docs link or formatted Word version as well!']
2025-07-20 22:02:19 | INFO  | __main__:run:51 | Passing documents to CrewAI for final report generation...
2025-07-20 22:02:26 | INFO  | __main__:run:58 | 
--- Final Report ---
2025-07-20 22:02:26 | INFO  | __main__:run:59 | # Company Leave Policy Guide

## Overview
This guide provides detailed information on the company's leave policy, including types of leave, how to request leave, and important contacts. 

## 1. **Review the Employee Handbook**
The detailed leave policy is available in the **Employee Handbook**, which can be accessed from the company intranet. This document will provide comprehensive information on all types of leave available.

## 2. **Types of Leave**

### **Paid Annual Leave**
- Employees are entitled to a minimum of 20 days of paid annual leave.

### **Sick Leave**
- Employees are provided with sick leave to cover periods of illness.

### **Bereavement Leave**
- Specific leave is available for employees dealing with the loss of a family member.

## 3. **Requesting Leave**
To request leave, employees should:
- Speak to their manager.
- Submit a formal leave request through the company’s designated process, which may involve using an online system or filling out a form.

## 4. **Notification**
It is important to notify your supervisor and HR as early as possible if you are running late or unable to attend work due to illness or other reasons that may require leave.

## 5. **HR Contacts**
For any questions or assistance regarding leave policies, contact the HR team:

- **HR Manager**: Sarah Liu – [sarah.liu@yueniutech.com](mailto:sarah.liu@yueniutech.com)
- **HR Generalist**: Tom Zhang – [tom.zhang@yueniutech.com](mailto:tom.zhang@yueniutech.com)
- **Phone**: +64 9 123 4567

## 6. **Additional Resources**
For more detailed information and specific procedures, refer to the **Employee Handbook** on the intranet.

---

**Image:** A chart showing Q3 sales. (Path: /path/to/image.png)

---

By following these steps, employees can effectively understand and utilize the company's leave policy.
2025-07-20 22:02:26 | INFO  | __main__:run:60 | --------------------

2025-07-20 22:13:38 | INFO  | __main__:run:40 | Received query: 'what's the company's leave policy?'
2025-07-20 22:13:38 | INFO  | rag.utils.milvus_manager:__init__:17 | Successfully connected to Milvus.
2025-07-20 22:13:38 | INFO  | rag.utils.milvus_manager:_create_collection_if_not_exists:28 | Collection 'rag_collection' already exists.
2025-07-20 22:13:39 | INFO  | rag.utils.retriever:retrieve:46 | Embedding query and retrieving documents for: 'what's the company's leave policy?'
2025-07-20 22:13:39 | INFO  | rag.utils.retriever:_embed_query:93 | Embedding query (real)...
2025-07-20 22:13:39 | INFO  | rag.utils.retriever:_search_milvus:116 | Searching Milvus for top 50 results...
2025-07-20 22:13:39 | INFO  | rag.utils.retriever:_rerank_documents:65 | Reranking documents...
2025-07-20 22:13:40 | INFO  | rag.utils.retriever:_rerank_documents:78 | Reranked 5 documents.
2025-07-20 22:13:40 | INFO  | __main__:run:45 | Documents: ["•\nLeadership training and mentoring opportunities\nSpeak to your manager or HR about your career path and development goals.\n10. Company Culture and Social Events\nWe believe that a happy team is a productive team. We regularly host:\n•\nTeam lunches and happy hours\n•\nHackathons and innovation days\n•\nMental health and wellness programs\n•\nMonthly recognition awards\n11. Resignation and Exit Process\nIf you choose to leave Yueniu Tech, we ask that you provide a minimum of four weeks' notice. HR \nwill guide you through the offboarding process and schedule an exit interview to gather feedback.\n12. Important Policies and Documents (Available on the \nIntranet)\nPlease take time to review the following documents, which can be accessed from the company \nintranet:\n•\nCode of Conduct\n•\nEmployee Handbook\n•\nData Protection and Privacy Policy\n•\nEqual Employment Opportunity Policy\n•\nRemote Work Guidelines\nFinal Words", '6.5 Health and Safety\nWe are dedicated to providing a safe work environment. Familiarize yourself with emergency exits, \nfirst aid kits, and safety procedures.\n7. Payroll and Benefits\nEmployees are paid monthly via direct deposit. Standard employee benefits include:\n•\nHealth insurance\n•\nPaid annual leave (minimum 20 days)\n•\nSick leave and bereavement leave\n•\nKiwiSaver contributions (for NZ-based employees)\n•\nProfessional development and training programs\n8. Performance Reviews\nPerformance reviews are conducted biannually to assess your progress, set career goals, and \nidentify training opportunities. We encourage open and constructive feedback between employees \nand managers.\n9. Career Development\nYueniu Tech supports your career growth through:\n•\nInternal job mobility\n•\nAccess to industry conferences and certifications\n•\nLeadership training and mentoring opportunities\nSpeak to your manager or HR about your career path and development goals.\n10. Company Culture and Social Events', '•\nHR Manager: Sarah Liu – sarah.liu@yueniutech.com\n•\nHR Generalist: Tom Zhang – tom.zhang@yueniutech.com\n•\nPhone: +64 9 123 4567\n6. Workplace Policies\n6.1 Attendance and Punctuality\nRegular attendance is essential. If you are running late or unable to attend work, please notify your \nsupervisor and HR as early as possible.\n6.2 Dress Code\nOur dress code is smart casual unless otherwise specified for meetings or events.\n6.3 IT & Security Policies\nAll employees must adhere to the company’s IT usage and cybersecurity policies. Company \nequipment must be used for professional purposes only.\n6.4 Anti-Harassment Policy\nYueniu Tech is committed to maintaining a workplace free from harassment or discrimination. Any \nconcerns will be taken seriously and addressed promptly.\n6.5 Health and Safety\nWe are dedicated to providing a safe work environment. Familiarize yourself with emergency exits, \nfirst aid kits, and safety procedures.\n7. Payroll and Benefits', '•\nCustomer Focus: We prioritize the needs and satisfaction of our clients.\n•\nContinuous Improvement: We are committed to personal and professional growth.\n3. Your First Day\nOn your first day, please arrive at the reception by 9:00 AM. You will be greeted by our HR \nrepresentative, who will give you a tour of the office and introduce you to your team. Your \nworkstation will be set up, and you’ll receive your ID badge and necessary equipment.\n4. Required Documents\nPlease bring the following documents on your first day:\n•\nValid government-issued ID\n•\nBank account details for payroll setup\n•\nSigned offer letter and employment contract\n•\nCompleted tax forms (IR330 for New Zealand employees)\n•\nWork visa (if applicable)\n5. HR Contacts\nIf you have any questions or concerns, our HR team is here to help:\n•\nHR Manager: Sarah Liu – sarah.liu@yueniutech.com\n•\nHR Generalist: Tom Zhang – tom.zhang@yueniutech.com\n•\nPhone: +64 9 123 4567\n6. Workplace Policies\n6.1 Attendance and Punctuality', 'intranet:\n•\nCode of Conduct\n•\nEmployee Handbook\n•\nData Protection and Privacy Policy\n•\nEqual Employment Opportunity Policy\n•\nRemote Work Guidelines\nFinal Words\nWe hope this guide gives you a comprehensive overview of what to expect at Yueniu Tech. If you \never have questions or need support, please don’t hesitate to reach out to your manager or the HR \nteam.\nWelcome aboard – we’re excited to have you with us!\nLet me know if you’d like a Google Docs link or formatted Word version as well!']
2025-07-20 22:13:40 | INFO  | __main__:run:51 | Passing documents to CrewAI for final report generation...
2025-07-20 22:13:46 | INFO  | __main__:run:58 | 
--- Final Report ---
2025-07-20 22:13:46 | INFO  | __main__:run:59 | # Yueniu Tech's Leave Policy Guide

## Introduction
Welcome to Yueniu Tech! This guide provides a comprehensive overview of our leave policy to ensure you understand your entitlements and the process for accessing detailed information.

## Reviewing the Employee Handbook
The leave policy is detailed in the **Employee Handbook**, which is available on the company intranet. It is essential to review this document for comprehensive information.

## Types of Leave
Yueniu Tech offers various types of leave to support your well-being and personal needs:

- **Paid Annual Leave**: Employees are entitled to a minimum of 20 days of paid annual leave.
- **Sick Leave**: Available for when you are unwell.
- **Bereavement Leave**: Provided for the loss of a close family member.

## Accessing the Intranet
To access the Employee Handbook, follow these steps:

1. **Log in to the company intranet** using your employee credentials.
2. **Navigate to the "Important Policies and Documents" section**.

## Downloading and Reading the Employee Handbook
1. **Find the Employee Handbook** in the listed documents.
2. **Download and thoroughly read the sections** related to leave policies.

## Contact HR for Clarifications
If you have any questions or need further clarification, please reach out to the HR team using the following contacts:

- **HR Manager**: Sarah Liu – [sarah.liu@yueniutech.com](mailto:sarah.liu@yueniutech.com)
- **HR Generalist**: Tom Zhang – [tom.zhang@yueniutech.com](mailto:tom.zhang@yueniutech.com)
- **Phone**: +64 9 123 4567

## Additional Resources
If you’d like a Google Docs link or formatted Word version of the Employee Handbook, please request it from the HR team.

---

**Image:** A chart showing Q3 sales. (Path: /path/to/image.png)
---

## Final Words
We hope this guide gives you a comprehensive overview of Yueniu Tech's leave policy. If you ever have questions or need support, please don’t hesitate to reach out to your manager or the HR team.

Welcome aboard – we’re excited to have you with us!
2025-07-20 22:13:46 | INFO  | __main__:run:60 | --------------------

2025-07-20 22:17:30 | INFO  | __main__:run:40 | Received query: 'what's the company's leave policy?'
2025-07-20 22:17:30 | INFO  | rag.utils.milvus_manager:__init__:17 | Successfully connected to Milvus.
2025-07-20 22:17:30 | INFO  | rag.utils.milvus_manager:_create_collection_if_not_exists:28 | Collection 'rag_collection' already exists.
2025-07-20 22:17:31 | INFO  | rag.utils.retriever:retrieve:46 | Embedding query and retrieving documents for: 'what's the company's leave policy?'
2025-07-20 22:17:31 | INFO  | rag.utils.retriever:_embed_query:93 | Embedding query (real)...
2025-07-20 22:17:31 | INFO  | rag.utils.retriever:_search_milvus:116 | Searching Milvus for top 50 results...
2025-07-20 22:17:31 | INFO  | rag.utils.retriever:_rerank_documents:65 | Reranking documents...
2025-07-20 22:17:32 | INFO  | rag.utils.retriever:_rerank_documents:78 | Reranked 5 documents.
2025-07-20 22:17:32 | INFO  | __main__:run:45 | Documents: ["•\nLeadership training and mentoring opportunities\nSpeak to your manager or HR about your career path and development goals.\n10. Company Culture and Social Events\nWe believe that a happy team is a productive team. We regularly host:\n•\nTeam lunches and happy hours\n•\nHackathons and innovation days\n•\nMental health and wellness programs\n•\nMonthly recognition awards\n11. Resignation and Exit Process\nIf you choose to leave Yueniu Tech, we ask that you provide a minimum of four weeks' notice. HR \nwill guide you through the offboarding process and schedule an exit interview to gather feedback.\n12. Important Policies and Documents (Available on the \nIntranet)\nPlease take time to review the following documents, which can be accessed from the company \nintranet:\n•\nCode of Conduct\n•\nEmployee Handbook\n•\nData Protection and Privacy Policy\n•\nEqual Employment Opportunity Policy\n•\nRemote Work Guidelines\nFinal Words", '6.5 Health and Safety\nWe are dedicated to providing a safe work environment. Familiarize yourself with emergency exits, \nfirst aid kits, and safety procedures.\n7. Payroll and Benefits\nEmployees are paid monthly via direct deposit. Standard employee benefits include:\n•\nHealth insurance\n•\nPaid annual leave (minimum 20 days)\n•\nSick leave and bereavement leave\n•\nKiwiSaver contributions (for NZ-based employees)\n•\nProfessional development and training programs\n8. Performance Reviews\nPerformance reviews are conducted biannually to assess your progress, set career goals, and \nidentify training opportunities. We encourage open and constructive feedback between employees \nand managers.\n9. Career Development\nYueniu Tech supports your career growth through:\n•\nInternal job mobility\n•\nAccess to industry conferences and certifications\n•\nLeadership training and mentoring opportunities\nSpeak to your manager or HR about your career path and development goals.\n10. Company Culture and Social Events', '•\nHR Manager: Sarah Liu – sarah.liu@yueniutech.com\n•\nHR Generalist: Tom Zhang – tom.zhang@yueniutech.com\n•\nPhone: +64 9 123 4567\n6. Workplace Policies\n6.1 Attendance and Punctuality\nRegular attendance is essential. If you are running late or unable to attend work, please notify your \nsupervisor and HR as early as possible.\n6.2 Dress Code\nOur dress code is smart casual unless otherwise specified for meetings or events.\n6.3 IT & Security Policies\nAll employees must adhere to the company’s IT usage and cybersecurity policies. Company \nequipment must be used for professional purposes only.\n6.4 Anti-Harassment Policy\nYueniu Tech is committed to maintaining a workplace free from harassment or discrimination. Any \nconcerns will be taken seriously and addressed promptly.\n6.5 Health and Safety\nWe are dedicated to providing a safe work environment. Familiarize yourself with emergency exits, \nfirst aid kits, and safety procedures.\n7. Payroll and Benefits', '•\nCustomer Focus: We prioritize the needs and satisfaction of our clients.\n•\nContinuous Improvement: We are committed to personal and professional growth.\n3. Your First Day\nOn your first day, please arrive at the reception by 9:00 AM. You will be greeted by our HR \nrepresentative, who will give you a tour of the office and introduce you to your team. Your \nworkstation will be set up, and you’ll receive your ID badge and necessary equipment.\n4. Required Documents\nPlease bring the following documents on your first day:\n•\nValid government-issued ID\n•\nBank account details for payroll setup\n•\nSigned offer letter and employment contract\n•\nCompleted tax forms (IR330 for New Zealand employees)\n•\nWork visa (if applicable)\n5. HR Contacts\nIf you have any questions or concerns, our HR team is here to help:\n•\nHR Manager: Sarah Liu – sarah.liu@yueniutech.com\n•\nHR Generalist: Tom Zhang – tom.zhang@yueniutech.com\n•\nPhone: +64 9 123 4567\n6. Workplace Policies\n6.1 Attendance and Punctuality', 'intranet:\n•\nCode of Conduct\n•\nEmployee Handbook\n•\nData Protection and Privacy Policy\n•\nEqual Employment Opportunity Policy\n•\nRemote Work Guidelines\nFinal Words\nWe hope this guide gives you a comprehensive overview of what to expect at Yueniu Tech. If you \never have questions or need support, please don’t hesitate to reach out to your manager or the HR \nteam.\nWelcome aboard – we’re excited to have you with us!\nLet me know if you’d like a Google Docs link or formatted Word version as well!']
2025-07-20 22:17:32 | INFO  | __main__:run:51 | Passing documents to CrewAI for final report generation...
2025-07-20 22:17:40 | INFO  | __main__:run:58 | 
--- Final Report ---
2025-07-20 22:17:40 | INFO  | __main__:run:59 | # Company Leave Policy Guide

## Overview
This guide provides a comprehensive overview of the company's leave policy to ensure employees understand their entitlements and the process for requesting leave.

## 1. Review the Employee Handbook
The leave policy is detailed in the **Employee Handbook**, which is available on the company intranet. Make sure to review this document thoroughly for specific details and updates.

## 2. Understand the Types of Leave
The company offers several types of leave:

- **Paid Annual Leave**: Employees are entitled to a minimum of 20 days of paid annual leave per year.
- **Sick Leave**: Employees are provided with sick leave for when they are unwell.
- **Bereavement Leave**: Employees are granted leave for bereavement purposes.

## 3. Check Accrual Rates
The **Employee Handbook** will specify how leave accrues over time. Typically, annual leave accrues monthly.

## 4. Requesting Leave
To request leave, follow these steps:
- Submit a formal request to your manager. This can often be done through an online system or by filling out a leave request form.
- Ensure you provide sufficient notice as per company policy.

## 5. Approval Process
Your manager will review your leave request. Approval may depend on team coverage and project deadlines. Once approved, your leave will be recorded in the company’s leave management system.

## 6. During Your Leave
While on leave, you should:
- Not perform any work-related tasks unless explicitly allowed by your manager.
- Stay reachable for any urgent matters if necessary.

## 7. Returning from Leave
When returning from leave:
- Notify your manager of your return date in advance.
- You may be required to submit any necessary documentation, such as a medical certificate for sick leave.

## 8. Additional Resources
If you have any questions or need further clarification, contact the HR team:

- **HR Manager**: Sarah Liu – sarah.liu@yueniutech.com
- **HR Generalist**: Tom Zhang – tom.zhang@yueniutech.com
- **Phone**: +64 9 123 4567

For detailed and specific information, always refer to the **Employee Handbook** available on the intranet.

---

**Image:** A chart showing Q3 sales. (Path: /path/to/image.png)
---

This guide aims to provide clear and concise information on the company's leave policy. For any further queries, please reach out to the HR team.
2025-07-20 22:17:40 | INFO  | __main__:run:60 | --------------------

2025-07-20 22:21:30 | INFO  | __main__:run:40 | Received query: 'what's the company's leave policy?'
2025-07-20 22:21:30 | INFO  | rag.utils.milvus_manager:__init__:17 | Successfully connected to Milvus.
2025-07-20 22:21:30 | INFO  | rag.utils.milvus_manager:_create_collection_if_not_exists:28 | Collection 'rag_collection' already exists.
2025-07-20 22:21:31 | INFO  | rag.utils.retriever:retrieve:46 | Embedding query and retrieving documents for: 'what's the company's leave policy?'
2025-07-20 22:21:31 | INFO  | rag.utils.retriever:_embed_query:93 | Embedding query (real)...
2025-07-20 22:21:31 | INFO  | rag.utils.retriever:_search_milvus:116 | Searching Milvus for top 50 results...
2025-07-20 22:21:31 | INFO  | rag.utils.retriever:_rerank_documents:65 | Reranking documents...
2025-07-20 22:21:32 | INFO  | rag.utils.retriever:_rerank_documents:78 | Reranked 5 documents.
2025-07-20 22:21:32 | INFO  | __main__:run:45 | Documents: ["•\nLeadership training and mentoring opportunities\nSpeak to your manager or HR about your career path and development goals.\n10. Company Culture and Social Events\nWe believe that a happy team is a productive team. We regularly host:\n•\nTeam lunches and happy hours\n•\nHackathons and innovation days\n•\nMental health and wellness programs\n•\nMonthly recognition awards\n11. Resignation and Exit Process\nIf you choose to leave Yueniu Tech, we ask that you provide a minimum of four weeks' notice. HR \nwill guide you through the offboarding process and schedule an exit interview to gather feedback.\n12. Important Policies and Documents (Available on the \nIntranet)\nPlease take time to review the following documents, which can be accessed from the company \nintranet:\n•\nCode of Conduct\n•\nEmployee Handbook\n•\nData Protection and Privacy Policy\n•\nEqual Employment Opportunity Policy\n•\nRemote Work Guidelines\nFinal Words", '6.5 Health and Safety\nWe are dedicated to providing a safe work environment. Familiarize yourself with emergency exits, \nfirst aid kits, and safety procedures.\n7. Payroll and Benefits\nEmployees are paid monthly via direct deposit. Standard employee benefits include:\n•\nHealth insurance\n•\nPaid annual leave (minimum 20 days)\n•\nSick leave and bereavement leave\n•\nKiwiSaver contributions (for NZ-based employees)\n•\nProfessional development and training programs\n8. Performance Reviews\nPerformance reviews are conducted biannually to assess your progress, set career goals, and \nidentify training opportunities. We encourage open and constructive feedback between employees \nand managers.\n9. Career Development\nYueniu Tech supports your career growth through:\n•\nInternal job mobility\n•\nAccess to industry conferences and certifications\n•\nLeadership training and mentoring opportunities\nSpeak to your manager or HR about your career path and development goals.\n10. Company Culture and Social Events', '•\nHR Manager: Sarah Liu – sarah.liu@yueniutech.com\n•\nHR Generalist: Tom Zhang – tom.zhang@yueniutech.com\n•\nPhone: +64 9 123 4567\n6. Workplace Policies\n6.1 Attendance and Punctuality\nRegular attendance is essential. If you are running late or unable to attend work, please notify your \nsupervisor and HR as early as possible.\n6.2 Dress Code\nOur dress code is smart casual unless otherwise specified for meetings or events.\n6.3 IT & Security Policies\nAll employees must adhere to the company’s IT usage and cybersecurity policies. Company \nequipment must be used for professional purposes only.\n6.4 Anti-Harassment Policy\nYueniu Tech is committed to maintaining a workplace free from harassment or discrimination. Any \nconcerns will be taken seriously and addressed promptly.\n6.5 Health and Safety\nWe are dedicated to providing a safe work environment. Familiarize yourself with emergency exits, \nfirst aid kits, and safety procedures.\n7. Payroll and Benefits', '•\nCustomer Focus: We prioritize the needs and satisfaction of our clients.\n•\nContinuous Improvement: We are committed to personal and professional growth.\n3. Your First Day\nOn your first day, please arrive at the reception by 9:00 AM. You will be greeted by our HR \nrepresentative, who will give you a tour of the office and introduce you to your team. Your \nworkstation will be set up, and you’ll receive your ID badge and necessary equipment.\n4. Required Documents\nPlease bring the following documents on your first day:\n•\nValid government-issued ID\n•\nBank account details for payroll setup\n•\nSigned offer letter and employment contract\n•\nCompleted tax forms (IR330 for New Zealand employees)\n•\nWork visa (if applicable)\n5. HR Contacts\nIf you have any questions or concerns, our HR team is here to help:\n•\nHR Manager: Sarah Liu – sarah.liu@yueniutech.com\n•\nHR Generalist: Tom Zhang – tom.zhang@yueniutech.com\n•\nPhone: +64 9 123 4567\n6. Workplace Policies\n6.1 Attendance and Punctuality', 'intranet:\n•\nCode of Conduct\n•\nEmployee Handbook\n•\nData Protection and Privacy Policy\n•\nEqual Employment Opportunity Policy\n•\nRemote Work Guidelines\nFinal Words\nWe hope this guide gives you a comprehensive overview of what to expect at Yueniu Tech. If you \never have questions or need support, please don’t hesitate to reach out to your manager or the HR \nteam.\nWelcome aboard – we’re excited to have you with us!\nLet me know if you’d like a Google Docs link or formatted Word version as well!']
2025-07-20 22:21:32 | INFO  | __main__:run:51 | Passing documents to CrewAI for final report generation...
2025-07-20 22:21:40 | INFO  | __main__:run:58 | 
--- Final Report ---
2025-07-20 22:21:40 | INFO  | __main__:run:59 | # Company Leave Policy Guide

## Introduction
This guide provides a comprehensive overview of the company's leave policy. It is essential for all employees to understand their entitlements and the procedures for taking leave.

## 1. Review the Employee Handbook
- The leave policy is detailed in the **Employee Handbook**, available on the company intranet. Ensure you review this document thoroughly for complete information.

## 2. Understand the Types of Leave
The company offers several types of leave:
- **Paid Annual Leave**: Employees are entitled to a minimum of 20 days of paid annual leave.
- **Sick Leave**: Employees are entitled to sick leave, though the specific number of days may vary.
- **Bereavement Leave**: Employees are entitled to bereavement leave, though the specific number of days may vary.

## 3. Check Eligibility
- Ensure you meet the eligibility criteria for the type of leave you wish to take. This information is typically found in the Employee Handbook.

## 4. Notify Your Manager
- Inform your direct manager about your intention to take leave. This should be done as early as possible to allow for proper planning and coverage.

## 5. Submit a Leave Request
- Follow the company’s procedure for submitting a leave request. This may involve filling out a form or sending an email to your manager and HR.

## 6. HR Approval
- Your leave request will need to be approved by the HR department. Ensure you follow up if you do not receive a response within the expected timeframe.

## 7. Plan for Your Absence
- Make arrangements to ensure your work responsibilities are covered during your absence. This may involve delegating tasks to colleagues or completing urgent work before you leave.

## 8. Return to Work
- Upon returning from leave, briefly inform your manager about your return. If necessary, discuss any work that needs attention or any changes that occurred during your absence.

## Additional Resources
For more detailed information, refer to the **Employee Handbook** available on the intranet.

---

**Image:** A chart showing Q3 sales. (Path: /path/to/image.png)
---

This guide aims to provide clear and concise information on the company's leave policy. For any further questions or clarifications, please contact the HR department.
2025-07-20 22:21:40 | INFO  | __main__:run:60 | --------------------

2025-07-20 22:29:17 | INFO  | __main__:run:40 | Received query: 'what's the company's leave policy?'
2025-07-20 22:29:17 | INFO  | rag.utils.milvus_manager:__init__:17 | Successfully connected to Milvus.
2025-07-20 22:29:17 | INFO  | rag.utils.milvus_manager:_create_collection_if_not_exists:28 | Collection 'rag_collection' already exists.
2025-07-20 22:29:17 | INFO  | rag.utils.retriever:retrieve:46 | Embedding query and retrieving documents for: 'what's the company's leave policy?'
2025-07-20 22:29:17 | INFO  | rag.utils.retriever:_embed_query:93 | Embedding query (real)...
2025-07-20 22:29:17 | INFO  | rag.utils.retriever:_search_milvus:116 | Searching Milvus for top 50 results...
2025-07-20 22:29:17 | INFO  | rag.utils.retriever:_rerank_documents:65 | Reranking documents...
2025-07-20 22:29:18 | INFO  | rag.utils.retriever:_rerank_documents:78 | Reranked 5 documents.
2025-07-20 22:29:18 | INFO  | __main__:run:45 | Documents: ["•\nLeadership training and mentoring opportunities\nSpeak to your manager or HR about your career path and development goals.\n10. Company Culture and Social Events\nWe believe that a happy team is a productive team. We regularly host:\n•\nTeam lunches and happy hours\n•\nHackathons and innovation days\n•\nMental health and wellness programs\n•\nMonthly recognition awards\n11. Resignation and Exit Process\nIf you choose to leave Yueniu Tech, we ask that you provide a minimum of four weeks' notice. HR \nwill guide you through the offboarding process and schedule an exit interview to gather feedback.\n12. Important Policies and Documents (Available on the \nIntranet)\nPlease take time to review the following documents, which can be accessed from the company \nintranet:\n•\nCode of Conduct\n•\nEmployee Handbook\n•\nData Protection and Privacy Policy\n•\nEqual Employment Opportunity Policy\n•\nRemote Work Guidelines\nFinal Words", '6.5 Health and Safety\nWe are dedicated to providing a safe work environment. Familiarize yourself with emergency exits, \nfirst aid kits, and safety procedures.\n7. Payroll and Benefits\nEmployees are paid monthly via direct deposit. Standard employee benefits include:\n•\nHealth insurance\n•\nPaid annual leave (minimum 20 days)\n•\nSick leave and bereavement leave\n•\nKiwiSaver contributions (for NZ-based employees)\n•\nProfessional development and training programs\n8. Performance Reviews\nPerformance reviews are conducted biannually to assess your progress, set career goals, and \nidentify training opportunities. We encourage open and constructive feedback between employees \nand managers.\n9. Career Development\nYueniu Tech supports your career growth through:\n•\nInternal job mobility\n•\nAccess to industry conferences and certifications\n•\nLeadership training and mentoring opportunities\nSpeak to your manager or HR about your career path and development goals.\n10. Company Culture and Social Events', '•\nHR Manager: Sarah Liu – sarah.liu@yueniutech.com\n•\nHR Generalist: Tom Zhang – tom.zhang@yueniutech.com\n•\nPhone: +64 9 123 4567\n6. Workplace Policies\n6.1 Attendance and Punctuality\nRegular attendance is essential. If you are running late or unable to attend work, please notify your \nsupervisor and HR as early as possible.\n6.2 Dress Code\nOur dress code is smart casual unless otherwise specified for meetings or events.\n6.3 IT & Security Policies\nAll employees must adhere to the company’s IT usage and cybersecurity policies. Company \nequipment must be used for professional purposes only.\n6.4 Anti-Harassment Policy\nYueniu Tech is committed to maintaining a workplace free from harassment or discrimination. Any \nconcerns will be taken seriously and addressed promptly.\n6.5 Health and Safety\nWe are dedicated to providing a safe work environment. Familiarize yourself with emergency exits, \nfirst aid kits, and safety procedures.\n7. Payroll and Benefits', '•\nCustomer Focus: We prioritize the needs and satisfaction of our clients.\n•\nContinuous Improvement: We are committed to personal and professional growth.\n3. Your First Day\nOn your first day, please arrive at the reception by 9:00 AM. You will be greeted by our HR \nrepresentative, who will give you a tour of the office and introduce you to your team. Your \nworkstation will be set up, and you’ll receive your ID badge and necessary equipment.\n4. Required Documents\nPlease bring the following documents on your first day:\n•\nValid government-issued ID\n•\nBank account details for payroll setup\n•\nSigned offer letter and employment contract\n•\nCompleted tax forms (IR330 for New Zealand employees)\n•\nWork visa (if applicable)\n5. HR Contacts\nIf you have any questions or concerns, our HR team is here to help:\n•\nHR Manager: Sarah Liu – sarah.liu@yueniutech.com\n•\nHR Generalist: Tom Zhang – tom.zhang@yueniutech.com\n•\nPhone: +64 9 123 4567\n6. Workplace Policies\n6.1 Attendance and Punctuality', 'intranet:\n•\nCode of Conduct\n•\nEmployee Handbook\n•\nData Protection and Privacy Policy\n•\nEqual Employment Opportunity Policy\n•\nRemote Work Guidelines\nFinal Words\nWe hope this guide gives you a comprehensive overview of what to expect at Yueniu Tech. If you \never have questions or need support, please don’t hesitate to reach out to your manager or the HR \nteam.\nWelcome aboard – we’re excited to have you with us!\nLet me know if you’d like a Google Docs link or formatted Word version as well!']
2025-07-20 22:29:18 | INFO  | __main__:run:51 | Passing documents to CrewAI for final report generation...
2025-07-20 22:29:26 | INFO  | __main__:run:58 | 
--- Final Report ---
2025-07-20 22:29:26 | INFO  | __main__:run:59 | # Company Leave Policy Guide

Welcome to our comprehensive guide on the company's leave policy. This guide aims to provide you with a clear understanding of the various types of leave available, how to request leave, and who to contact for further assistance.

## 1. Review the Employee Handbook

The leave policy is detailed in the **Employee Handbook**, which is available on the company intranet. Make sure to review this document thoroughly for the most accurate and up-to-date information.

## 2. Understand the Types of Leave

### Paid Annual Leave
- Employees are entitled to a minimum of **20 days** of paid annual leave.

### Sick Leave
- Employees are provided with sick leave for when they are unwell.

### Bereavement Leave
- Employees are granted leave for bereavement purposes.

## 3. Check Your Entitlement

Your specific entitlement to leave may vary based on your length of service and other factors. Refer to the **Employee Handbook** for detailed information.

## 4. Requesting Leave

To request leave, you should:
- Speak to your manager.
- Submit a formal leave request through the company’s designated process. This may involve using an online system or filling out a leave request form.

## 5. Notification

Notify your manager and HR as early as possible when you are running late or unable to attend work due to leave. This is in line with the **Attendance and Punctuality policy**.

## 6. HR Contacts

If you have any questions or need further clarification on the leave policy, contact the HR team:

- **HR Manager**: Sarah Liu – `sarah.liu@yueniutech.com`
- **HR Generalist**: Tom Zhang – `tom.zhang@yueniutech.com`
- **Phone**: `+64 9 123 4567`

## 7. Additional Resources

For more detailed information, access the following documents on the intranet:
- Code of Conduct
- Employee Handbook
- Data Protection and Privacy Policy
- Equal Employment Opportunity Policy
- Remote Work Guidelines

If you need a Google Docs link or a formatted Word version of these documents, please reach out to your manager or the HR team. 

---

**Welcome aboard – we’re excited to have you with us!**
2025-07-20 22:29:26 | INFO  | __main__:run:60 | --------------------

2025-07-20 22:43:04 | INFO  | __main__:serve:95 | Starting the RAG Crew API server...
2025-07-20 22:44:09 | INFO  | __main__:serve:95 | Starting the RAG Crew API server...
2025-07-20 22:44:58 | INFO  | rag.api:query_rag:72 | Received query: 'what's the company's leave policy?'
2025-07-20 22:44:58 | INFO  | rag.utils.milvus_manager:__init__:17 | Successfully connected to Milvus.
2025-07-20 22:44:58 | INFO  | rag.utils.milvus_manager:_create_collection_if_not_exists:28 | Collection 'rag_collection' already exists.
2025-07-20 22:44:58 | INFO  | rag.utils.retriever:retrieve:46 | Embedding query and retrieving documents for: 'what's the company's leave policy?'
2025-07-20 22:44:58 | INFO  | rag.utils.retriever:_embed_query:93 | Embedding query (real)...
2025-07-20 22:44:59 | INFO  | rag.utils.retriever:_search_milvus:116 | Searching Milvus for top 50 results...
2025-07-20 22:44:59 | INFO  | rag.utils.retriever:_rerank_documents:65 | Reranking documents...
2025-07-20 22:45:00 | INFO  | rag.utils.retriever:_rerank_documents:78 | Reranked 5 documents.
2025-07-20 22:45:00 | INFO  | rag.api:query_rag:83 | Retrieved 5 documents for the query.
2025-07-20 22:45:06 | INFO  | rag.api:query_rag:92 | Successfully generated the final report.
2025-07-20 22:49:49 | INFO  | rag.api:query_rag:72 | Received query: 'what's the company's leave policy?'
2025-07-20 22:49:49 | INFO  | rag.utils.milvus_manager:__init__:17 | Successfully connected to Milvus.
2025-07-20 22:49:49 | INFO  | rag.utils.milvus_manager:_create_collection_if_not_exists:28 | Collection 'rag_collection' already exists.
2025-07-20 22:49:49 | INFO  | rag.utils.retriever:retrieve:46 | Embedding query and retrieving documents for: 'what's the company's leave policy?'
2025-07-20 22:49:49 | INFO  | rag.utils.retriever:_embed_query:100 | Embedding query (real)...
2025-07-20 22:49:49 | INFO  | rag.utils.retriever:_search_milvus:123 | Searching Milvus for top 50 results...
2025-07-20 22:49:50 | ERROR | rag.api:query_rag:109 | An error occurred during the query process: Hit.get() takes 2 positional arguments but 3 were given
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 3
               │     └ 12
               └ <function _main at 0x1017d4cc0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 3
           │    └ <function BaseProcess._bootstrap at 0x10158d1c0>
           └ <SpawnProcess name='SpawnProcess-5' parent=54586 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10158c720>
    └ <SpawnProcess name='SpawnProcess-5' parent=54586 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x172a078f0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-5' parent=54586 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-5' parent=54586 started>
    │    └ <function subprocess_started at 0x173555260>
    └ <SpawnProcess name='SpawnProcess-5' parent=54586 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1735817f0>>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
           │       │   │    └ <function Server.serve at 0x1735547c0>
           │       │   └ <uvicorn.server.Server object at 0x1735817f0>
           │       └ <function run at 0x101dc2980>
           └ <module 'asyncio' from '/Users/jadoreran/miniconda3/lib/python3.12/asyncio/__init__.py'>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x173536ce0>
           │      └ <function Runner.run at 0x101e202c0>
           └ <asyncio.runners.Runner object at 0x17333d670>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/...
           │    │     └ <cyfunction Loop.run_until_complete at 0x1735c2330>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x17333d670>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x173581250>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x177514b90>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x177514b...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1733dbec0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x173581250>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x177514b90>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x177514b...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x177514b90>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x177514b...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1774d6c90>
          └ <fastapi.applications.FastAPI object at 0x1733dbec0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1774da840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x177514b...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1774d72f0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1774d6c90>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1774da840>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x177514b...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x1774d6d20>
          │                            │    └ <fastapi.routing.APIRouter object at 0x17391bb60>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1774d72f0>
          └ <function wrap_app_handling_exceptions at 0x173cb0540>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1774da980>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x177514b...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <fastapi.routing.APIRouter object at 0x17391bb60>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1774da980>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x177514b...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x17391bb60>>
          └ <fastapi.routing.APIRouter object at 0x17391bb60>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1774da980>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x177514b...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │     └ <function Route.handle at 0x173cb1b20>
          └ APIRoute(path='/query', name='query_rag', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1774da980>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x177514b...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function request_response.<locals>.app at 0x1774da2a0>
          └ APIRoute(path='/query', name='query_rag', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1774da980>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x177514b...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x177514d70>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1774daa20>
          └ <function wrap_app_handling_exceptions at 0x173cb0540>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1774dab60>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x177514b...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x1774daa20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x177514d70>
                     └ <function get_request_handler.<locals>.app at 0x1774da200>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x173cb1620>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': QueryRequest(query="what's the company's leave policy?")}
                 │         └ <function query_rag at 0x1774d9c60>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

> File "/private/tmp/rag-demo/rag/src/rag/api.py", line 77, in query_rag
    documents = retriever.retrieve(request.query)
                │         │        │       └ "what's the company's leave policy?"
                │         │        └ QueryRequest(query="what's the company's leave policy?")
                │         └ <function Retriever.retrieve at 0x172fdf1a0>
                └ <rag.utils.retriever.Retriever object at 0x177429f10>

  File "/private/tmp/rag-demo/rag/src/rag/utils/retriever.py", line 56, in retrieve
    "content": hit.entity.get('text', ''),

TypeError: Hit.get() takes 2 positional arguments but 3 were given
2025-07-20 22:50:01 | INFO  | rag.api:query_rag:72 | Received query: 'what's the company's leave policy?'
2025-07-20 22:50:01 | INFO  | rag.utils.milvus_manager:__init__:17 | Successfully connected to Milvus.
2025-07-20 22:50:01 | INFO  | rag.utils.milvus_manager:_create_collection_if_not_exists:28 | Collection 'rag_collection' already exists.
2025-07-20 22:50:01 | INFO  | rag.utils.retriever:retrieve:46 | Embedding query and retrieving documents for: 'what's the company's leave policy?'
2025-07-20 22:50:01 | INFO  | rag.utils.retriever:_embed_query:100 | Embedding query (real)...
2025-07-20 22:50:02 | INFO  | rag.utils.retriever:_search_milvus:123 | Searching Milvus for top 50 results...
2025-07-20 22:50:02 | ERROR | rag.api:query_rag:109 | An error occurred during the query process: Hit.get() takes 2 positional arguments but 3 were given
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 3
               │     └ 12
               └ <function _main at 0x1017d4cc0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 3
           │    └ <function BaseProcess._bootstrap at 0x10158d1c0>
           └ <SpawnProcess name='SpawnProcess-5' parent=54586 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10158c720>
    └ <SpawnProcess name='SpawnProcess-5' parent=54586 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x172a078f0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-5' parent=54586 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-5' parent=54586 started>
    │    └ <function subprocess_started at 0x173555260>
    └ <SpawnProcess name='SpawnProcess-5' parent=54586 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1735817f0>>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
           │       │   │    └ <function Server.serve at 0x1735547c0>
           │       │   └ <uvicorn.server.Server object at 0x1735817f0>
           │       └ <function run at 0x101dc2980>
           └ <module 'asyncio' from '/Users/jadoreran/miniconda3/lib/python3.12/asyncio/__init__.py'>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x173536ce0>
           │      └ <function Runner.run at 0x101e202c0>
           └ <asyncio.runners.Runner object at 0x17333d670>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/...
           │    │     └ <cyfunction Loop.run_until_complete at 0x1735c2330>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x17333d670>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x173581250>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179a4a0c0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179a4a0...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1733dbec0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x173581250>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179a4a0c0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179a4a0...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179a4a0c0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179a4a0...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1774d6c90>
          └ <fastapi.applications.FastAPI object at 0x1733dbec0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x17a8d5bc0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179a4a0...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1774d72f0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1774d6c90>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x17a8d5bc0>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179a4a0...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x178d72390>
          │                            │    └ <fastapi.routing.APIRouter object at 0x17391bb60>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1774d72f0>
          └ <function wrap_app_handling_exceptions at 0x173cb0540>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17a8d5a80>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179a4a0...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <fastapi.routing.APIRouter object at 0x17391bb60>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17a8d5a80>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179a4a0...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x17391bb60>>
          └ <fastapi.routing.APIRouter object at 0x17391bb60>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17a8d5a80>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179a4a0...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │     └ <function Route.handle at 0x173cb1b20>
          └ APIRoute(path='/query', name='query_rag', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17a8d5a80>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179a4a0...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function request_response.<locals>.app at 0x1774da2a0>
          └ APIRoute(path='/query', name='query_rag', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17a8d5a80>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179a4a0...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x178d8d100>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x17a8d5d00>
          └ <function wrap_app_handling_exceptions at 0x173cb0540>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17a8d5e40>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179a4a0...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x17a8d5d00>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x178d8d100>
                     └ <function get_request_handler.<locals>.app at 0x1774da200>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x173cb1620>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': QueryRequest(query="what's the company's leave policy?")}
                 │         └ <function query_rag at 0x1774d9c60>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

> File "/private/tmp/rag-demo/rag/src/rag/api.py", line 77, in query_rag
    documents = retriever.retrieve(request.query)
                │         │        │       └ "what's the company's leave policy?"
                │         │        └ QueryRequest(query="what's the company's leave policy?")
                │         └ <function Retriever.retrieve at 0x172fdf1a0>
                └ <rag.utils.retriever.Retriever object at 0x17755b230>

  File "/private/tmp/rag-demo/rag/src/rag/utils/retriever.py", line 56, in retrieve
    "content": hit.entity.get('text', ''),

TypeError: Hit.get() takes 2 positional arguments but 3 were given
2025-07-20 22:52:46 | INFO  | rag.api:query_rag:72 | Received query: 'what's the company's leave policy?'
2025-07-20 22:52:46 | INFO  | rag.utils.milvus_manager:__init__:17 | Successfully connected to Milvus.
2025-07-20 22:52:46 | INFO  | rag.utils.milvus_manager:_create_collection_if_not_exists:28 | Collection 'rag_collection' already exists.
2025-07-20 22:52:46 | INFO  | rag.utils.retriever:retrieve:45 | Embedding query and retrieving documents for: 'what's the company's leave policy?'
2025-07-20 22:52:46 | INFO  | rag.utils.retriever:_embed_query:82 | Embedding query (real)...
2025-07-20 22:52:46 | INFO  | rag.utils.retriever:_search_milvus:105 | Searching Milvus for top 50 results...
2025-07-20 22:52:46 | INFO  | rag.api:query_rag:83 | Retrieved 6 documents for the query.
2025-07-20 22:52:55 | INFO  | rag.api:query_rag:92 | Successfully generated the final report.
2025-07-20 22:54:29 | INFO  | rag.api:query_rag:72 | Received query: 'what's the company's leave policy?'
2025-07-20 22:54:29 | INFO  | rag.utils.milvus_manager:__init__:17 | Successfully connected to Milvus.
2025-07-20 22:54:29 | INFO  | rag.utils.milvus_manager:_create_collection_if_not_exists:28 | Collection 'rag_collection' already exists.
2025-07-20 22:54:29 | INFO  | rag.utils.retriever:retrieve:46 | Embedding query and retrieving documents for: 'what's the company's leave policy?'
2025-07-20 22:54:29 | INFO  | rag.utils.retriever:_embed_query:93 | Embedding query (real)...
2025-07-20 22:54:29 | INFO  | rag.utils.retriever:_search_milvus:116 | Searching Milvus for top 50 results...
2025-07-20 22:54:30 | INFO  | rag.utils.retriever:_rerank_documents:65 | Reranking documents...
2025-07-20 22:54:31 | INFO  | rag.utils.retriever:_rerank_documents:78 | Reranked 5 documents.
2025-07-20 22:54:31 | INFO  | rag.api:query_rag:83 | Retrieved 5 documents for the query.
2025-07-20 22:54:41 | INFO  | rag.api:query_rag:92 | Successfully generated the final report.
2025-07-20 23:39:21 | INFO  | rag.api:query_rag:83 | Received query: 'app = FastAPI(     title="RAG Crew API",     description="An API for processing documents and answering questions using a RAG-based CrewAI.",     version="1.0.0" )'
2025-07-20 23:39:21 | INFO  | rag.utils.milvus_manager:__init__:17 | Successfully connected to Milvus.
2025-07-20 23:39:21 | INFO  | rag.utils.milvus_manager:_create_collection_if_not_exists:28 | Collection 'rag_collection' already exists.
2025-07-20 23:39:22 | INFO  | rag.utils.retriever:retrieve:46 | Embedding query and retrieving documents for: 'app = FastAPI(     title="RAG Crew API",     description="An API for processing documents and answering questions using a RAG-based CrewAI.",     version="1.0.0" )'
2025-07-20 23:39:22 | INFO  | rag.utils.retriever:_embed_query:93 | Embedding query (real)...
2025-07-20 23:39:22 | INFO  | rag.utils.retriever:_search_milvus:116 | Searching Milvus for top 50 results...
2025-07-20 23:39:22 | INFO  | rag.utils.retriever:_rerank_documents:65 | Reranking documents...
2025-07-20 23:39:23 | INFO  | rag.utils.retriever:_rerank_documents:78 | Reranked 5 documents.
2025-07-20 23:39:23 | INFO  | rag.api:query_rag:94 | Retrieved 5 documents for the query.
2025-07-20 23:42:57 | INFO  | rag.api:query_rag:83 | Received query: 'what the company's policy?'
2025-07-20 23:42:57 | INFO  | rag.utils.milvus_manager:__init__:17 | Successfully connected to Milvus.
2025-07-20 23:42:57 | INFO  | rag.utils.milvus_manager:_create_collection_if_not_exists:28 | Collection 'rag_collection' already exists.
2025-07-20 23:42:57 | INFO  | rag.utils.retriever:retrieve:46 | Embedding query and retrieving documents for: 'what the company's policy?'
2025-07-20 23:42:57 | INFO  | rag.utils.retriever:_embed_query:93 | Embedding query (real)...
2025-07-20 23:42:58 | INFO  | rag.utils.retriever:_search_milvus:116 | Searching Milvus for top 50 results...
2025-07-20 23:42:58 | INFO  | rag.utils.retriever:_rerank_documents:65 | Reranking documents...
2025-07-20 23:42:58 | INFO  | rag.utils.retriever:_rerank_documents:78 | Reranked 5 documents.
2025-07-20 23:42:58 | INFO  | rag.api:query_rag:94 | Retrieved 5 documents for the query.
2025-07-21 15:59:46 | INFO  | __main__:serve:98 | Starting the RAG Crew API server...
2025-07-21 16:24:55 | INFO  | rag.api:upload_file:55 | File 'media.docx' uploaded to temporary path: /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmp9mqp_gy6/media.docx
2025-07-21 16:24:55 | INFO  | rag.utils.milvus_manager:__init__:17 | Successfully connected to Milvus.
2025-07-21 16:24:55 | INFO  | rag.utils.milvus_manager:_create_collection_if_not_exists:28 | Collection 'rag_collection' already exists.
2025-07-21 16:24:55 | INFO  | rag.utils.document_processor:process_document:58 | Processing document: /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmp9mqp_gy6/media.docx
2025-07-21 16:24:55 | INFO  | rag.utils.document_processor:_extract_from_docx:124 | Extracting from DOCX: /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmp9mqp_gy6/media.docx
2025-07-21 16:24:55 | INFO  | rag.utils.document_processor:_extract_from_docx:153 | Extracted 1 images from /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmp9mqp_gy6/media.docx
2025-07-21 16:24:55 | INFO  | rag.utils.document_processor:_describe_images_and_insert_placeholders:163 | Describing 1 images...
2025-07-21 16:24:56 | INFO  | rag.utils.document_processor:_get_image_description:186 | Getting description for rag/knowledge/images/docx_media_img1.png (real)...
2025-07-21 16:24:56 | ERROR | rag.utils.document_processor:_invoke_bedrock:273 | A Bedrock client error occurred when invoking apac.amazon.nova-lite-v1:0: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
2025-07-21 16:24:56 | ERROR | rag.utils.document_processor:_get_image_description:218 | Error getting description for rag/knowledge/images/docx_media_img1.png: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 3
               │     └ 12
               └ <function _main at 0x10567ccc0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 3
           │    └ <function BaseProcess._bootstrap at 0x1054351c0>
           └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x105434720>
    └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x176907e90>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
    │    └ <function subprocess_started at 0x1773bd8a0>
    └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1773e5940>>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
           │       │   │    └ <function Server.serve at 0x1773bccc0>
           │       │   └ <uvicorn.server.Server object at 0x1773e5940>
           │       └ <function run at 0x105817420>
           └ <module 'asyncio' from '/Users/jadoreran/miniconda3/lib/python3.12/asyncio/__init__.py'>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x17739edc0>
           │      └ <function Runner.run at 0x105cc8220>
           └ <asyncio.runners.Runner object at 0x176ec5f70>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/...
           │    │     └ <cyfunction Loop.run_until_complete at 0x17740a740>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x176ec5f70>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x177435340>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9f0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x177434f80>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x177435340>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9f0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9f0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17bbe3e90>
          └ <fastapi.applications.FastAPI object at 0x177434f80>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x17bbe5760>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17bbe3e90>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'connection': 'keep-alive', 'content-length': '36646', 'sec-ch-ua-platform': '"macOS"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x17bbe5760>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x17bbe5120>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17bbe3920>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x17bd198e0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x17bba1a30>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17bbe3920>
          └ <function wrap_app_handling_exceptions at 0x17bb9ca40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17bbe5800>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <fastapi.routing.APIRouter object at 0x17bba1a30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17bbe5800>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x17bba1a30>>
          └ <fastapi.routing.APIRouter object at 0x17bba1a30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17bbe5800>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │     └ <function Route.handle at 0x17bb9e020>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17bbe5800>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function request_response.<locals>.app at 0x17bbe62a0>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17bbe5800>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x17bd19850>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x17bbe63e0>
          └ <function wrap_app_handling_exceptions at 0x17bb9ca40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17bbe6520>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x17bbe63e0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x17bd19850>
                     └ <function get_request_handler.<locals>.app at 0x17bbe6200>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x17bb9db20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': UploadFile(filename='media.docx', size=36401, headers=Headers({'content-disposition': 'form-data; name="file"; filen...
                 │         └ <function upload_file at 0x17bbe58a0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=File(Pydant...

  File "/private/tmp/rag-demo/rag/src/rag/api.py", line 60, in upload_file
    processed_chunks = doc_processor.process_document(str(temp_path))
                       │             │                    └ PosixPath('/var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmp9mqp_gy6/media.docx')
                       │             └ <function DocumentProcessor.process_document at 0x17026f100>
                       └ <rag.utils.document_processor.DocumentProcessor object at 0x1773a3e00>

  File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 63, in process_document
    processed_text = self._describe_images_and_insert_placeholders(raw_text, extracted_images)
                     │    │                                        │         └ [PosixPath('rag/knowledge/images/docx_media_img1.png')]
                     │    │                                        └ '\n[image_placeholder:rag/knowledge/images/docx_media_img1.png]\nmedia_type\n\n\n\n\nend\n'
                     │    └ <function DocumentProcessor._describe_images_and_insert_placeholders at 0x17042ad40>
                     └ <rag.utils.document_processor.DocumentProcessor object at 0x1773a3e00>

  File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 165, in _describe_images_and_insert_placeholders
    description = self._get_image_description(img_path)
                  │    │                      └ PosixPath('rag/knowledge/images/docx_media_img1.png')
                  │    └ <function DocumentProcessor._get_image_description at 0x17042ade0>
                  └ <rag.utils.document_processor.DocumentProcessor object at 0x1773a3e00>

> File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 214, in _get_image_description
    response_body = self._invoke_bedrock("apac.amazon.nova-lite-v1:0", request_body)
                    │    │                                             └ {'messages': [{'role': 'user', 'content': [{'image': {'format': 'png', 'source': {'bytes': 'iVBORw0KGgoAAAANSUhEUgAAAZIAAAEzC...
                    │    └ <function DocumentProcessor._invoke_bedrock at 0x17042af20>
                    └ <rag.utils.document_processor.DocumentProcessor object at 0x1773a3e00>

  File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 265, in _invoke_bedrock
    response = self.bedrock_client.invoke_model(
               │    │              └ <function ClientCreator._create_api_method.<locals>._api_call at 0x17c4184a0>
               │    └ <botocore.client.BedrockRuntime object at 0x17bbe33e0>
               └ <rag.utils.document_processor.DocumentProcessor object at 0x1773a3e00>

  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/client.py", line 595, in _api_call
    return self._make_api_call(operation_name, kwargs)
           │    │              │               └ {'body': '{"messages": [{"role": "user", "content": [{"image": {"format": "png", "source": {"bytes": "iVBORw0KGgoAAAANSUhEUgA...
           │    │              └ 'InvokeModel'
           │    └ <function BaseClient._make_api_call at 0x13f1be980>
           └ <botocore.client.BedrockRuntime object at 0x17bbe33e0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/context.py", line 123, in wrapper
    return func(*args, **kwargs)
           │     │       └ {}
           │     └ (<botocore.client.BedrockRuntime object at 0x17bbe33e0>, 'InvokeModel', {'body': '{"messages": [{"role": "user", "content": [...
           └ <function BaseClient._make_api_call at 0x13f1be8e0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/client.py", line 1058, in _make_api_call
    raise error_class(parsed_response, operation_name)
          │           │                └ 'InvokeModel'
          │           └ {'Error': {'Message': "You don't have access to the model with the specified model ID.", 'Code': 'AccessDeniedException'}, 'R...
          └ <class 'botocore.errorfactory.AccessDeniedException'>

botocore.errorfactory.AccessDeniedException: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
2025-07-21 16:24:56 | WARNING | rag.utils.document_processor:process_document:64 | Processed text: 
[image_info]{"description": "Error describing image: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.", "imgpath": "/private/tmp/rademo/rag/rag/knowledge/images/docx_media_img1.png"}[/image_info]
media_type




end

2025-07-21 16:24:56 | INFO  | rag.utils.document_processor:_generate_embeddings:233 | Generating embeddings for 1 chunks (real)...
2025-07-21 16:24:56 | ERROR | rag.utils.document_processor:_generate_embeddings:257 | Error generating embedding for chunk: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 3
               │     └ 12
               └ <function _main at 0x10567ccc0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 3
           │    └ <function BaseProcess._bootstrap at 0x1054351c0>
           └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x105434720>
    └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x176907e90>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
    │    └ <function subprocess_started at 0x1773bd8a0>
    └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1773e5940>>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
           │       │   │    └ <function Server.serve at 0x1773bccc0>
           │       │   └ <uvicorn.server.Server object at 0x1773e5940>
           │       └ <function run at 0x105817420>
           └ <module 'asyncio' from '/Users/jadoreran/miniconda3/lib/python3.12/asyncio/__init__.py'>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x17739edc0>
           │      └ <function Runner.run at 0x105cc8220>
           └ <asyncio.runners.Runner object at 0x176ec5f70>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/...
           │    │     └ <cyfunction Loop.run_until_complete at 0x17740a740>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x176ec5f70>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x177435340>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9f0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x177434f80>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x177435340>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9f0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9f0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17bbe3e90>
          └ <fastapi.applications.FastAPI object at 0x177434f80>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x17bbe5760>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17bbe3e90>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'connection': 'keep-alive', 'content-length': '36646', 'sec-ch-ua-platform': '"macOS"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x17bbe5760>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x17bbe5120>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17bbe3920>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x17bd198e0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x17bba1a30>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17bbe3920>
          └ <function wrap_app_handling_exceptions at 0x17bb9ca40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17bbe5800>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <fastapi.routing.APIRouter object at 0x17bba1a30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17bbe5800>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x17bba1a30>>
          └ <fastapi.routing.APIRouter object at 0x17bba1a30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17bbe5800>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │     └ <function Route.handle at 0x17bb9e020>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17bbe5800>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function request_response.<locals>.app at 0x17bbe62a0>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17bbe5800>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x17bd19850>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x17bbe63e0>
          └ <function wrap_app_handling_exceptions at 0x17bb9ca40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17bbe6520>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x17bbe63e0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x17bd19850>
                     └ <function get_request_handler.<locals>.app at 0x17bbe6200>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x17bb9db20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': UploadFile(filename='media.docx', size=36401, headers=Headers({'content-disposition': 'form-data; name="file"; filen...
                 │         └ <function upload_file at 0x17bbe58a0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=File(Pydant...

  File "/private/tmp/rag-demo/rag/src/rag/api.py", line 60, in upload_file
    processed_chunks = doc_processor.process_document(str(temp_path))
                       │             │                    └ PosixPath('/var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmp9mqp_gy6/media.docx')
                       │             └ <function DocumentProcessor.process_document at 0x17026f100>
                       └ <rag.utils.document_processor.DocumentProcessor object at 0x1773a3e00>

  File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 70, in process_document
    processed_chunks = self._generate_embeddings(text_chunks)
                       │    │                    └ ['[image_info]{"description": "Error describing image: An error occurred (AccessDeniedException) when calling the InvokeModel...
                       │    └ <function DocumentProcessor._generate_embeddings at 0x17042ae80>
                       └ <rag.utils.document_processor.DocumentProcessor object at 0x1773a3e00>

> File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 243, in _generate_embeddings
    response = self.bedrock_client.invoke_model(
               │    │              └ <function ClientCreator._create_api_method.<locals>._api_call at 0x17c4184a0>
               │    └ <botocore.client.BedrockRuntime object at 0x17bbe33e0>
               └ <rag.utils.document_processor.DocumentProcessor object at 0x1773a3e00>

  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/client.py", line 595, in _api_call
    return self._make_api_call(operation_name, kwargs)
           │    │              │               └ {'body': '{"inputText": "[image_info]{\\"description\\": \\"Error describing image: An error occurred (AccessDeniedException)...
           │    │              └ 'InvokeModel'
           │    └ <function BaseClient._make_api_call at 0x13f1be980>
           └ <botocore.client.BedrockRuntime object at 0x17bbe33e0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/context.py", line 123, in wrapper
    return func(*args, **kwargs)
           │     │       └ {}
           │     └ (<botocore.client.BedrockRuntime object at 0x17bbe33e0>, 'InvokeModel', {'body': '{"inputText": "[image_info]{\\"description\...
           └ <function BaseClient._make_api_call at 0x13f1be8e0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/client.py", line 1058, in _make_api_call
    raise error_class(parsed_response, operation_name)
          │           │                └ 'InvokeModel'
          │           └ {'Error': {'Message': "You don't have access to the model with the specified model ID.", 'Code': 'AccessDeniedException'}, 'R...
          └ <class 'botocore.errorfactory.AccessDeniedException'>

botocore.errorfactory.AccessDeniedException: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
2025-07-21 16:24:56 | INFO  | rag.utils.document_processor:process_document:72 | Successfully processed 0 chunks from /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmp9mqp_gy6/media.docx
2025-07-21 16:24:56 | WARNING | rag.api:upload_file:67 | No content could be processed from 'media.docx'.
2025-07-21 16:24:56 | ERROR | rag.api:upload_file:71 | An error occurred during file upload and processing: 400: No content could be processed from the file.
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 3
               │     └ 12
               └ <function _main at 0x10567ccc0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 3
           │    └ <function BaseProcess._bootstrap at 0x1054351c0>
           └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x105434720>
    └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x176907e90>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
    │    └ <function subprocess_started at 0x1773bd8a0>
    └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1773e5940>>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
           │       │   │    └ <function Server.serve at 0x1773bccc0>
           │       │   └ <uvicorn.server.Server object at 0x1773e5940>
           │       └ <function run at 0x105817420>
           └ <module 'asyncio' from '/Users/jadoreran/miniconda3/lib/python3.12/asyncio/__init__.py'>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x17739edc0>
           │      └ <function Runner.run at 0x105cc8220>
           └ <asyncio.runners.Runner object at 0x176ec5f70>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/...
           │    │     └ <cyfunction Loop.run_until_complete at 0x17740a740>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x176ec5f70>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x177435340>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9f0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x177434f80>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x177435340>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9f0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9f0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17bbe3e90>
          └ <fastapi.applications.FastAPI object at 0x177434f80>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x17bbe5760>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17bbe3e90>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'connection': 'keep-alive', 'content-length': '36646', 'sec-ch-ua-platform': '"macOS"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x17bbe5760>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x17bbe5120>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17bbe3920>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x17bd198e0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x17bba1a30>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17bbe3920>
          └ <function wrap_app_handling_exceptions at 0x17bb9ca40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17bbe5800>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <fastapi.routing.APIRouter object at 0x17bba1a30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17bbe5800>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x17bba1a30>>
          └ <fastapi.routing.APIRouter object at 0x17bba1a30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17bbe5800>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │     └ <function Route.handle at 0x17bb9e020>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17bbe5800>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function request_response.<locals>.app at 0x17bbe62a0>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17bbe5800>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x17bd19850>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x17bbe63e0>
          └ <function wrap_app_handling_exceptions at 0x17bb9ca40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17bbe6520>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd1a9...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x17bbe63e0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x17bd19850>
                     └ <function get_request_handler.<locals>.app at 0x17bbe6200>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x17bb9db20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': UploadFile(filename='media.docx', size=36401, headers=Headers({'content-disposition': 'form-data; name="file"; filen...
                 │         └ <function upload_file at 0x17bbe58a0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=File(Pydant...

> File "/private/tmp/rag-demo/rag/src/rag/api.py", line 68, in upload_file
    raise HTTPException(status_code=400, detail="No content could be processed from the file.")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 400: No content could be processed from the file.
2025-07-21 16:25:03 | INFO  | rag.api:upload_file:55 | File 'media.docx' uploaded to temporary path: /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmpzi4lo9e7/media.docx
2025-07-21 16:25:04 | INFO  | rag.utils.milvus_manager:__init__:17 | Successfully connected to Milvus.
2025-07-21 16:25:04 | INFO  | rag.utils.milvus_manager:_create_collection_if_not_exists:28 | Collection 'rag_collection' already exists.
2025-07-21 16:25:04 | INFO  | rag.utils.document_processor:process_document:58 | Processing document: /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmpzi4lo9e7/media.docx
2025-07-21 16:25:04 | INFO  | rag.utils.document_processor:_extract_from_docx:124 | Extracting from DOCX: /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmpzi4lo9e7/media.docx
2025-07-21 16:25:04 | INFO  | rag.utils.document_processor:_extract_from_docx:153 | Extracted 1 images from /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmpzi4lo9e7/media.docx
2025-07-21 16:25:04 | INFO  | rag.utils.document_processor:_describe_images_and_insert_placeholders:163 | Describing 1 images...
2025-07-21 16:25:04 | INFO  | rag.utils.document_processor:_get_image_description:186 | Getting description for rag/knowledge/images/docx_media_img1.png (real)...
2025-07-21 16:25:04 | ERROR | rag.utils.document_processor:_invoke_bedrock:273 | A Bedrock client error occurred when invoking apac.amazon.nova-lite-v1:0: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
2025-07-21 16:25:04 | ERROR | rag.utils.document_processor:_get_image_description:218 | Error getting description for rag/knowledge/images/docx_media_img1.png: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 3
               │     └ 12
               └ <function _main at 0x10567ccc0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 3
           │    └ <function BaseProcess._bootstrap at 0x1054351c0>
           └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x105434720>
    └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x176907e90>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
    │    └ <function subprocess_started at 0x1773bd8a0>
    └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1773e5940>>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
           │       │   │    └ <function Server.serve at 0x1773bccc0>
           │       │   └ <uvicorn.server.Server object at 0x1773e5940>
           │       └ <function run at 0x105817420>
           └ <module 'asyncio' from '/Users/jadoreran/miniconda3/lib/python3.12/asyncio/__init__.py'>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x17739edc0>
           │      └ <function Runner.run at 0x105cc8220>
           └ <asyncio.runners.Runner object at 0x176ec5f70>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/...
           │    │     └ <cyfunction Loop.run_until_complete at 0x17740a740>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x176ec5f70>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x177435340>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd19100>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x177434f80>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x177435340>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd19100>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd19100>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17bbe3e90>
          └ <fastapi.applications.FastAPI object at 0x177434f80>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x12a109580>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17bbe3e90>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'connection': 'keep-alive', 'content-length': '36646', 'sec-ch-ua-platform': '"macOS"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x12a109580>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x17bbe5120>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17bbe3920>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x17bd19610>
          │                            │    └ <fastapi.routing.APIRouter object at 0x17bba1a30>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17bbe3920>
          └ <function wrap_app_handling_exceptions at 0x17bb9ca40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17c4e7a60>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <fastapi.routing.APIRouter object at 0x17bba1a30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17c4e7a60>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x17bba1a30>>
          └ <fastapi.routing.APIRouter object at 0x17bba1a30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17c4e7a60>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │     └ <function Route.handle at 0x17bb9e020>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17c4e7a60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function request_response.<locals>.app at 0x17bbe62a0>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17c4e7a60>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x17bd19a60>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x17c4e79c0>
          └ <function wrap_app_handling_exceptions at 0x17bb9ca40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17c4e7ba0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x17c4e79c0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x17bd19a60>
                     └ <function get_request_handler.<locals>.app at 0x17bbe6200>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x17bb9db20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': UploadFile(filename='media.docx', size=36401, headers=Headers({'content-disposition': 'form-data; name="file"; filen...
                 │         └ <function upload_file at 0x17bbe58a0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=File(Pydant...

  File "/private/tmp/rag-demo/rag/src/rag/api.py", line 60, in upload_file
    processed_chunks = doc_processor.process_document(str(temp_path))
                       │             │                    └ PosixPath('/var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmpzi4lo9e7/media.docx')
                       │             └ <function DocumentProcessor.process_document at 0x17026f100>
                       └ <rag.utils.document_processor.DocumentProcessor object at 0x17c4c7e90>

  File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 63, in process_document
    processed_text = self._describe_images_and_insert_placeholders(raw_text, extracted_images)
                     │    │                                        │         └ [PosixPath('rag/knowledge/images/docx_media_img1.png')]
                     │    │                                        └ '\n[image_placeholder:rag/knowledge/images/docx_media_img1.png]\nmedia_type\n\n\n\n\nend\n'
                     │    └ <function DocumentProcessor._describe_images_and_insert_placeholders at 0x17042ad40>
                     └ <rag.utils.document_processor.DocumentProcessor object at 0x17c4c7e90>

  File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 165, in _describe_images_and_insert_placeholders
    description = self._get_image_description(img_path)
                  │    │                      └ PosixPath('rag/knowledge/images/docx_media_img1.png')
                  │    └ <function DocumentProcessor._get_image_description at 0x17042ade0>
                  └ <rag.utils.document_processor.DocumentProcessor object at 0x17c4c7e90>

> File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 214, in _get_image_description
    response_body = self._invoke_bedrock("apac.amazon.nova-lite-v1:0", request_body)
                    │    │                                             └ {'messages': [{'role': 'user', 'content': [{'image': {'format': 'png', 'source': {'bytes': 'iVBORw0KGgoAAAANSUhEUgAAAZIAAAEzC...
                    │    └ <function DocumentProcessor._invoke_bedrock at 0x17042af20>
                    └ <rag.utils.document_processor.DocumentProcessor object at 0x17c4c7e90>

  File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 265, in _invoke_bedrock
    response = self.bedrock_client.invoke_model(
               │    │              └ <function ClientCreator._create_api_method.<locals>._api_call at 0x17cc30040>
               │    └ <botocore.client.BedrockRuntime object at 0x1774357c0>
               └ <rag.utils.document_processor.DocumentProcessor object at 0x17c4c7e90>

  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/client.py", line 595, in _api_call
    return self._make_api_call(operation_name, kwargs)
           │    │              │               └ {'body': '{"messages": [{"role": "user", "content": [{"image": {"format": "png", "source": {"bytes": "iVBORw0KGgoAAAANSUhEUgA...
           │    │              └ 'InvokeModel'
           │    └ <function BaseClient._make_api_call at 0x13f1be980>
           └ <botocore.client.BedrockRuntime object at 0x1774357c0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/context.py", line 123, in wrapper
    return func(*args, **kwargs)
           │     │       └ {}
           │     └ (<botocore.client.BedrockRuntime object at 0x1774357c0>, 'InvokeModel', {'body': '{"messages": [{"role": "user", "content": [...
           └ <function BaseClient._make_api_call at 0x13f1be8e0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/client.py", line 1058, in _make_api_call
    raise error_class(parsed_response, operation_name)
          │           │                └ 'InvokeModel'
          │           └ {'Error': {'Message': "You don't have access to the model with the specified model ID.", 'Code': 'AccessDeniedException'}, 'R...
          └ <class 'botocore.errorfactory.AccessDeniedException'>

botocore.errorfactory.AccessDeniedException: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
2025-07-21 16:25:04 | WARNING | rag.utils.document_processor:process_document:64 | Processed text: 
[image_info]{"description": "Error describing image: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.", "imgpath": "/private/tmp/rademo/rag/rag/knowledge/images/docx_media_img1.png"}[/image_info]
media_type




end

2025-07-21 16:25:04 | INFO  | rag.utils.document_processor:_generate_embeddings:233 | Generating embeddings for 1 chunks (real)...
2025-07-21 16:25:04 | ERROR | rag.utils.document_processor:_generate_embeddings:257 | Error generating embedding for chunk: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 3
               │     └ 12
               └ <function _main at 0x10567ccc0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 3
           │    └ <function BaseProcess._bootstrap at 0x1054351c0>
           └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x105434720>
    └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x176907e90>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
    │    └ <function subprocess_started at 0x1773bd8a0>
    └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1773e5940>>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
           │       │   │    └ <function Server.serve at 0x1773bccc0>
           │       │   └ <uvicorn.server.Server object at 0x1773e5940>
           │       └ <function run at 0x105817420>
           └ <module 'asyncio' from '/Users/jadoreran/miniconda3/lib/python3.12/asyncio/__init__.py'>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x17739edc0>
           │      └ <function Runner.run at 0x105cc8220>
           └ <asyncio.runners.Runner object at 0x176ec5f70>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/...
           │    │     └ <cyfunction Loop.run_until_complete at 0x17740a740>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x176ec5f70>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x177435340>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd19100>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x177434f80>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x177435340>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd19100>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd19100>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17bbe3e90>
          └ <fastapi.applications.FastAPI object at 0x177434f80>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x12a109580>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17bbe3e90>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'connection': 'keep-alive', 'content-length': '36646', 'sec-ch-ua-platform': '"macOS"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x12a109580>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x17bbe5120>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17bbe3920>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x17bd19610>
          │                            │    └ <fastapi.routing.APIRouter object at 0x17bba1a30>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17bbe3920>
          └ <function wrap_app_handling_exceptions at 0x17bb9ca40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17c4e7a60>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <fastapi.routing.APIRouter object at 0x17bba1a30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17c4e7a60>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x17bba1a30>>
          └ <fastapi.routing.APIRouter object at 0x17bba1a30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17c4e7a60>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │     └ <function Route.handle at 0x17bb9e020>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17c4e7a60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function request_response.<locals>.app at 0x17bbe62a0>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17c4e7a60>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x17bd19a60>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x17c4e79c0>
          └ <function wrap_app_handling_exceptions at 0x17bb9ca40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17c4e7ba0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x17c4e79c0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x17bd19a60>
                     └ <function get_request_handler.<locals>.app at 0x17bbe6200>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x17bb9db20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': UploadFile(filename='media.docx', size=36401, headers=Headers({'content-disposition': 'form-data; name="file"; filen...
                 │         └ <function upload_file at 0x17bbe58a0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=File(Pydant...

  File "/private/tmp/rag-demo/rag/src/rag/api.py", line 60, in upload_file
    processed_chunks = doc_processor.process_document(str(temp_path))
                       │             │                    └ PosixPath('/var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmpzi4lo9e7/media.docx')
                       │             └ <function DocumentProcessor.process_document at 0x17026f100>
                       └ <rag.utils.document_processor.DocumentProcessor object at 0x17c4c7e90>

  File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 70, in process_document
    processed_chunks = self._generate_embeddings(text_chunks)
                       │    │                    └ ['[image_info]{"description": "Error describing image: An error occurred (AccessDeniedException) when calling the InvokeModel...
                       │    └ <function DocumentProcessor._generate_embeddings at 0x17042ae80>
                       └ <rag.utils.document_processor.DocumentProcessor object at 0x17c4c7e90>

> File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 243, in _generate_embeddings
    response = self.bedrock_client.invoke_model(
               │    │              └ <function ClientCreator._create_api_method.<locals>._api_call at 0x17cc30040>
               │    └ <botocore.client.BedrockRuntime object at 0x1774357c0>
               └ <rag.utils.document_processor.DocumentProcessor object at 0x17c4c7e90>

  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/client.py", line 595, in _api_call
    return self._make_api_call(operation_name, kwargs)
           │    │              │               └ {'body': '{"inputText": "[image_info]{\\"description\\": \\"Error describing image: An error occurred (AccessDeniedException)...
           │    │              └ 'InvokeModel'
           │    └ <function BaseClient._make_api_call at 0x13f1be980>
           └ <botocore.client.BedrockRuntime object at 0x1774357c0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/context.py", line 123, in wrapper
    return func(*args, **kwargs)
           │     │       └ {}
           │     └ (<botocore.client.BedrockRuntime object at 0x1774357c0>, 'InvokeModel', {'body': '{"inputText": "[image_info]{\\"description\...
           └ <function BaseClient._make_api_call at 0x13f1be8e0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/client.py", line 1058, in _make_api_call
    raise error_class(parsed_response, operation_name)
          │           │                └ 'InvokeModel'
          │           └ {'Error': {'Message': "You don't have access to the model with the specified model ID.", 'Code': 'AccessDeniedException'}, 'R...
          └ <class 'botocore.errorfactory.AccessDeniedException'>

botocore.errorfactory.AccessDeniedException: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
2025-07-21 16:25:04 | INFO  | rag.utils.document_processor:process_document:72 | Successfully processed 0 chunks from /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmpzi4lo9e7/media.docx
2025-07-21 16:25:04 | WARNING | rag.api:upload_file:67 | No content could be processed from 'media.docx'.
2025-07-21 16:25:04 | ERROR | rag.api:upload_file:71 | An error occurred during file upload and processing: 400: No content could be processed from the file.
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 3
               │     └ 12
               └ <function _main at 0x10567ccc0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 3
           │    └ <function BaseProcess._bootstrap at 0x1054351c0>
           └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x105434720>
    └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x176907e90>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
    │    └ <function subprocess_started at 0x1773bd8a0>
    └ <SpawnProcess name='SpawnProcess-1' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1773e5940>>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
           │       │   │    └ <function Server.serve at 0x1773bccc0>
           │       │   └ <uvicorn.server.Server object at 0x1773e5940>
           │       └ <function run at 0x105817420>
           └ <module 'asyncio' from '/Users/jadoreran/miniconda3/lib/python3.12/asyncio/__init__.py'>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x17739edc0>
           │      └ <function Runner.run at 0x105cc8220>
           └ <asyncio.runners.Runner object at 0x176ec5f70>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/...
           │    │     └ <cyfunction Loop.run_until_complete at 0x17740a740>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x176ec5f70>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x177435340>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd19100>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x177434f80>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x177435340>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd19100>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd19100>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17bbe3e90>
          └ <fastapi.applications.FastAPI object at 0x177434f80>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x12a109580>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17bbe3e90>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'connection': 'keep-alive', 'content-length': '36646', 'sec-ch-ua-platform': '"macOS"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x12a109580>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x17bbe5120>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17bbe3920>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x17bbe32c0>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x17bd19610>
          │                            │    └ <fastapi.routing.APIRouter object at 0x17bba1a30>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17bbe3920>
          └ <function wrap_app_handling_exceptions at 0x17bb9ca40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17c4e7a60>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <fastapi.routing.APIRouter object at 0x17bba1a30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17c4e7a60>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x17bba1a30>>
          └ <fastapi.routing.APIRouter object at 0x17bba1a30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17c4e7a60>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │     └ <function Route.handle at 0x17bb9e020>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17c4e7a60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function request_response.<locals>.app at 0x17bbe62a0>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17c4e7a60>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x17bd19a60>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x17c4e79c0>
          └ <function wrap_app_handling_exceptions at 0x17bb9ca40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x17c4e7ba0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x17bd191...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x17c4e79c0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x17bd19a60>
                     └ <function get_request_handler.<locals>.app at 0x17bbe6200>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x17bb9db20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': UploadFile(filename='media.docx', size=36401, headers=Headers({'content-disposition': 'form-data; name="file"; filen...
                 │         └ <function upload_file at 0x17bbe58a0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=File(Pydant...

> File "/private/tmp/rag-demo/rag/src/rag/api.py", line 68, in upload_file
    raise HTTPException(status_code=400, detail="No content could be processed from the file.")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 400: No content could be processed from the file.
2025-07-21 16:27:17 | INFO  | rag.api:upload_file:55 | File 'media.docx' uploaded to temporary path: /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmp427sppkn/media.docx
2025-07-21 16:27:18 | INFO  | rag.utils.milvus_manager:__init__:17 | Successfully connected to Milvus.
2025-07-21 16:27:18 | INFO  | rag.utils.milvus_manager:_create_collection_if_not_exists:28 | Collection 'rag_collection' already exists.
2025-07-21 16:27:18 | INFO  | rag.utils.document_processor:process_document:58 | Processing document: /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmp427sppkn/media.docx
2025-07-21 16:27:18 | INFO  | rag.utils.document_processor:_extract_from_docx:124 | Extracting from DOCX: /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmp427sppkn/media.docx
2025-07-21 16:27:18 | INFO  | rag.utils.document_processor:_extract_from_docx:153 | Extracted 1 images from /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmp427sppkn/media.docx
2025-07-21 16:27:18 | INFO  | rag.utils.document_processor:_describe_images_and_insert_placeholders:163 | Describing 1 images...
2025-07-21 16:27:18 | INFO  | rag.utils.document_processor:_get_image_description:186 | Getting description for rag/knowledge/images/docx_media_img1.png (real)...
2025-07-21 16:27:18 | ERROR | rag.utils.document_processor:_invoke_bedrock:273 | A Bedrock client error occurred when invoking apac.amazon.nova-lite-v1:0: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
2025-07-21 16:27:18 | ERROR | rag.utils.document_processor:_get_image_description:218 | Error getting description for rag/knowledge/images/docx_media_img1.png: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 3
               │     └ 12
               └ <function _main at 0x1036c8cc0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 3
           │    └ <function BaseProcess._bootstrap at 0x1034811c0>
           └ <SpawnProcess name='SpawnProcess-12' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x103480720>
    └ <SpawnProcess name='SpawnProcess-12' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x175d02780>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-12' parent=46140 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-12' parent=46140 started>
    │    └ <function subprocess_started at 0x175d558a0>
    └ <SpawnProcess name='SpawnProcess-12' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x175d7dbb0>>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
           │       │   │    └ <function Server.serve at 0x175d54cc0>
           │       │   └ <uvicorn.server.Server object at 0x175d7dbb0>
           │       └ <function run at 0x103863420>
           └ <module 'asyncio' from '/Users/jadoreran/miniconda3/lib/python3.12/asyncio/__init__.py'>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x175d36dc0>
           │      └ <function Runner.run at 0x103d14220>
           └ <asyncio.runners.Runner object at 0x175d3b770>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/...
           │    │     └ <cyfunction Loop.run_until_complete at 0x175da2740>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x175d3b770>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1753bdc70>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a70>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x175d38f80>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1753bdc70>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a70>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a70>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x179de3890>
          └ <fastapi.applications.FastAPI object at 0x175d38f80>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x179de5760>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x179de3440>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x179de3890>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'connection': 'keep-alive', 'content-length': '36646', 'sec-ch-ua-platform': '"macOS"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x179de5760>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x179de5120>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x179de3440>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x179de3440>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x179de3a40>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x179de3440>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x179de3440>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x179e18b00>
          │                            │    └ <fastapi.routing.APIRouter object at 0x179da1b50>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x179de3a40>
          └ <function wrap_app_handling_exceptions at 0x179d98a40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x179de5800>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <fastapi.routing.APIRouter object at 0x179da1b50>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x179de5800>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x179da1b50>>
          └ <fastapi.routing.APIRouter object at 0x179da1b50>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x179de5800>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │     └ <function Route.handle at 0x179d9a020>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x179de5800>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function request_response.<locals>.app at 0x179de62a0>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x179de5800>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x179e18c80>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x179de63e0>
          └ <function wrap_app_handling_exceptions at 0x179d98a40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x179de6520>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x179de63e0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x179e18c80>
                     └ <function get_request_handler.<locals>.app at 0x179de6200>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x179d99b20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': UploadFile(filename='media.docx', size=36401, headers=Headers({'content-disposition': 'form-data; name="file"; filen...
                 │         └ <function upload_file at 0x179de58a0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=File(Pydant...

  File "/private/tmp/rag-demo/rag/src/rag/api.py", line 60, in upload_file
    processed_chunks = doc_processor.process_document(str(temp_path))
                       │             │                    └ PosixPath('/var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmp427sppkn/media.docx')
                       │             └ <function DocumentProcessor.process_document at 0x16e96f100>
                       └ <rag.utils.document_processor.DocumentProcessor object at 0x179de3980>

  File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 63, in process_document
    processed_text = self._describe_images_and_insert_placeholders(raw_text, extracted_images)
                     │    │                                        │         └ [PosixPath('rag/knowledge/images/docx_media_img1.png')]
                     │    │                                        └ '\n[image_placeholder:rag/knowledge/images/docx_media_img1.png]\nmedia_type\n\n\n\n\nend\n'
                     │    └ <function DocumentProcessor._describe_images_and_insert_placeholders at 0x16ec1ad40>
                     └ <rag.utils.document_processor.DocumentProcessor object at 0x179de3980>

  File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 165, in _describe_images_and_insert_placeholders
    description = self._get_image_description(img_path)
                  │    │                      └ PosixPath('rag/knowledge/images/docx_media_img1.png')
                  │    └ <function DocumentProcessor._get_image_description at 0x16ec1ade0>
                  └ <rag.utils.document_processor.DocumentProcessor object at 0x179de3980>

> File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 214, in _get_image_description
    response_body = self._invoke_bedrock("apac.amazon.nova-lite-v1:0", request_body)
                    │    │                                             └ {'messages': [{'role': 'user', 'content': [{'image': {'format': 'png', 'source': {'bytes': 'iVBORw0KGgoAAAANSUhEUgAAAZIAAAEzC...
                    │    └ <function DocumentProcessor._invoke_bedrock at 0x16ec1af20>
                    └ <rag.utils.document_processor.DocumentProcessor object at 0x179de3980>

  File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 265, in _invoke_bedrock
    response = self.bedrock_client.invoke_model(
               │    │              └ <function ClientCreator._create_api_method.<locals>._api_call at 0x17a5184a0>
               │    └ <botocore.client.BedrockRuntime object at 0x17a544d40>
               └ <rag.utils.document_processor.DocumentProcessor object at 0x179de3980>

  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/client.py", line 595, in _api_call
    return self._make_api_call(operation_name, kwargs)
           │    │              │               └ {'body': '{"messages": [{"role": "user", "content": [{"image": {"format": "png", "source": {"bytes": "iVBORw0KGgoAAAANSUhEUgA...
           │    │              └ 'InvokeModel'
           │    └ <function BaseClient._make_api_call at 0x16b8be980>
           └ <botocore.client.BedrockRuntime object at 0x17a544d40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/context.py", line 123, in wrapper
    return func(*args, **kwargs)
           │     │       └ {}
           │     └ (<botocore.client.BedrockRuntime object at 0x17a544d40>, 'InvokeModel', {'body': '{"messages": [{"role": "user", "content": [...
           └ <function BaseClient._make_api_call at 0x16b8be8e0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/client.py", line 1058, in _make_api_call
    raise error_class(parsed_response, operation_name)
          │           │                └ 'InvokeModel'
          │           └ {'Error': {'Message': "You don't have access to the model with the specified model ID.", 'Code': 'AccessDeniedException'}, 'R...
          └ <class 'botocore.errorfactory.AccessDeniedException'>

botocore.errorfactory.AccessDeniedException: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
2025-07-21 16:27:18 | WARNING | rag.utils.document_processor:process_document:64 | Processed text: 
[image_info]{"description": "Error describing image: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.", "imgpath": "/private/tmp/rademo/rag/rag/knowledge/images/docx_media_img1.png"}[/image_info]
media_type




end

2025-07-21 16:27:18 | INFO  | rag.utils.document_processor:_generate_embeddings:233 | Generating embeddings for 1 chunks (real)...
2025-07-21 16:27:18 | ERROR | rag.utils.document_processor:_generate_embeddings:257 | Error generating embedding for chunk: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 3
               │     └ 12
               └ <function _main at 0x1036c8cc0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 3
           │    └ <function BaseProcess._bootstrap at 0x1034811c0>
           └ <SpawnProcess name='SpawnProcess-12' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x103480720>
    └ <SpawnProcess name='SpawnProcess-12' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x175d02780>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-12' parent=46140 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-12' parent=46140 started>
    │    └ <function subprocess_started at 0x175d558a0>
    └ <SpawnProcess name='SpawnProcess-12' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x175d7dbb0>>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
           │       │   │    └ <function Server.serve at 0x175d54cc0>
           │       │   └ <uvicorn.server.Server object at 0x175d7dbb0>
           │       └ <function run at 0x103863420>
           └ <module 'asyncio' from '/Users/jadoreran/miniconda3/lib/python3.12/asyncio/__init__.py'>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x175d36dc0>
           │      └ <function Runner.run at 0x103d14220>
           └ <asyncio.runners.Runner object at 0x175d3b770>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/...
           │    │     └ <cyfunction Loop.run_until_complete at 0x175da2740>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x175d3b770>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1753bdc70>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a70>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x175d38f80>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1753bdc70>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a70>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a70>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x179de3890>
          └ <fastapi.applications.FastAPI object at 0x175d38f80>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x179de5760>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x179de3440>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x179de3890>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'connection': 'keep-alive', 'content-length': '36646', 'sec-ch-ua-platform': '"macOS"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x179de5760>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x179de5120>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x179de3440>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x179de3440>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x179de3a40>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x179de3440>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x179de3440>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x179e18b00>
          │                            │    └ <fastapi.routing.APIRouter object at 0x179da1b50>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x179de3a40>
          └ <function wrap_app_handling_exceptions at 0x179d98a40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x179de5800>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <fastapi.routing.APIRouter object at 0x179da1b50>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x179de5800>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x179da1b50>>
          └ <fastapi.routing.APIRouter object at 0x179da1b50>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x179de5800>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │     └ <function Route.handle at 0x179d9a020>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x179de5800>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function request_response.<locals>.app at 0x179de62a0>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x179de5800>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x179e18c80>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x179de63e0>
          └ <function wrap_app_handling_exceptions at 0x179d98a40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x179de6520>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x179de63e0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x179e18c80>
                     └ <function get_request_handler.<locals>.app at 0x179de6200>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x179d99b20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': UploadFile(filename='media.docx', size=36401, headers=Headers({'content-disposition': 'form-data; name="file"; filen...
                 │         └ <function upload_file at 0x179de58a0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=File(Pydant...

  File "/private/tmp/rag-demo/rag/src/rag/api.py", line 60, in upload_file
    processed_chunks = doc_processor.process_document(str(temp_path))
                       │             │                    └ PosixPath('/var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmp427sppkn/media.docx')
                       │             └ <function DocumentProcessor.process_document at 0x16e96f100>
                       └ <rag.utils.document_processor.DocumentProcessor object at 0x179de3980>

  File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 70, in process_document
    processed_chunks = self._generate_embeddings(text_chunks)
                       │    │                    └ ['[image_info]{"description": "Error describing image: An error occurred (AccessDeniedException) when calling the InvokeModel...
                       │    └ <function DocumentProcessor._generate_embeddings at 0x16ec1ae80>
                       └ <rag.utils.document_processor.DocumentProcessor object at 0x179de3980>

> File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 243, in _generate_embeddings
    response = self.bedrock_client.invoke_model(
               │    │              └ <function ClientCreator._create_api_method.<locals>._api_call at 0x17a5184a0>
               │    └ <botocore.client.BedrockRuntime object at 0x17a544d40>
               └ <rag.utils.document_processor.DocumentProcessor object at 0x179de3980>

  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/client.py", line 595, in _api_call
    return self._make_api_call(operation_name, kwargs)
           │    │              │               └ {'body': '{"inputText": "[image_info]{\\"description\\": \\"Error describing image: An error occurred (AccessDeniedException)...
           │    │              └ 'InvokeModel'
           │    └ <function BaseClient._make_api_call at 0x16b8be980>
           └ <botocore.client.BedrockRuntime object at 0x17a544d40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/context.py", line 123, in wrapper
    return func(*args, **kwargs)
           │     │       └ {}
           │     └ (<botocore.client.BedrockRuntime object at 0x17a544d40>, 'InvokeModel', {'body': '{"inputText": "[image_info]{\\"description\...
           └ <function BaseClient._make_api_call at 0x16b8be8e0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/client.py", line 1058, in _make_api_call
    raise error_class(parsed_response, operation_name)
          │           │                └ 'InvokeModel'
          │           └ {'Error': {'Message': "You don't have access to the model with the specified model ID.", 'Code': 'AccessDeniedException'}, 'R...
          └ <class 'botocore.errorfactory.AccessDeniedException'>

botocore.errorfactory.AccessDeniedException: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
2025-07-21 16:27:18 | INFO  | rag.utils.document_processor:process_document:72 | Successfully processed 0 chunks from /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmp427sppkn/media.docx
2025-07-21 16:27:18 | WARNING | rag.api:upload_file:67 | No content could be processed from 'media.docx'.
2025-07-21 16:27:18 | ERROR | rag.api:upload_file:71 | An error occurred during file upload and processing: 400: No content could be processed from the file.
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 3
               │     └ 12
               └ <function _main at 0x1036c8cc0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 3
           │    └ <function BaseProcess._bootstrap at 0x1034811c0>
           └ <SpawnProcess name='SpawnProcess-12' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x103480720>
    └ <SpawnProcess name='SpawnProcess-12' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x175d02780>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-12' parent=46140 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-12' parent=46140 started>
    │    └ <function subprocess_started at 0x175d558a0>
    └ <SpawnProcess name='SpawnProcess-12' parent=46140 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x175d7dbb0>>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
           │       │   │    └ <function Server.serve at 0x175d54cc0>
           │       │   └ <uvicorn.server.Server object at 0x175d7dbb0>
           │       └ <function run at 0x103863420>
           └ <module 'asyncio' from '/Users/jadoreran/miniconda3/lib/python3.12/asyncio/__init__.py'>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x175d36dc0>
           │      └ <function Runner.run at 0x103d14220>
           └ <asyncio.runners.Runner object at 0x175d3b770>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/...
           │    │     └ <cyfunction Loop.run_until_complete at 0x175da2740>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x175d3b770>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1753bdc70>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a70>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x175d38f80>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1753bdc70>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a70>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a70>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x179de3890>
          └ <fastapi.applications.FastAPI object at 0x175d38f80>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x179de5760>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x179de3440>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x179de3890>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'connection': 'keep-alive', 'content-length': '36646', 'sec-ch-ua-platform': '"macOS"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x179de5760>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x179de5120>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x179de3440>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x179de3440>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x179de3a40>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x179de3440>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x179de3440>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x179e18b00>
          │                            │    └ <fastapi.routing.APIRouter object at 0x179da1b50>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x179de3a40>
          └ <function wrap_app_handling_exceptions at 0x179d98a40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x179de5800>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <fastapi.routing.APIRouter object at 0x179da1b50>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x179de5800>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x179da1b50>>
          └ <fastapi.routing.APIRouter object at 0x179da1b50>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x179de5800>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │     └ <function Route.handle at 0x179d9a020>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x179de5800>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function request_response.<locals>.app at 0x179de62a0>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x179de5800>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x179e18c80>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x179de63e0>
          └ <function wrap_app_handling_exceptions at 0x179d98a40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x179de6520>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x179e18a...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x179de63e0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x179e18c80>
                     └ <function get_request_handler.<locals>.app at 0x179de6200>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x179d99b20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': UploadFile(filename='media.docx', size=36401, headers=Headers({'content-disposition': 'form-data; name="file"; filen...
                 │         └ <function upload_file at 0x179de58a0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=File(Pydant...

> File "/private/tmp/rag-demo/rag/src/rag/api.py", line 68, in upload_file
    raise HTTPException(status_code=400, detail="No content could be processed from the file.")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 400: No content could be processed from the file.
2025-07-21 16:27:55 | INFO  | __main__:serve:98 | Starting the RAG Crew API server...
2025-07-21 16:27:58 | INFO  | rag.api:upload_file:55 | File 'media.docx' uploaded to temporary path: /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmpxut7g3w6/media.docx
2025-07-21 16:27:58 | INFO  | rag.utils.milvus_manager:__init__:17 | Successfully connected to Milvus.
2025-07-21 16:27:58 | INFO  | rag.utils.milvus_manager:_create_collection_if_not_exists:28 | Collection 'rag_collection' already exists.
2025-07-21 16:27:58 | INFO  | rag.utils.document_processor:process_document:58 | Processing document: /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmpxut7g3w6/media.docx
2025-07-21 16:27:58 | INFO  | rag.utils.document_processor:_extract_from_docx:124 | Extracting from DOCX: /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmpxut7g3w6/media.docx
2025-07-21 16:27:58 | INFO  | rag.utils.document_processor:_extract_from_docx:153 | Extracted 1 images from /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmpxut7g3w6/media.docx
2025-07-21 16:27:58 | INFO  | rag.utils.document_processor:_describe_images_and_insert_placeholders:163 | Describing 1 images...
2025-07-21 16:27:58 | INFO  | rag.utils.document_processor:_get_image_description:186 | Getting description for rag/knowledge/images/docx_media_img1.png (real)...
2025-07-21 16:27:59 | ERROR | rag.utils.document_processor:_invoke_bedrock:273 | A Bedrock client error occurred when invoking apac.amazon.nova-lite-v1:0: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
2025-07-21 16:27:59 | ERROR | rag.utils.document_processor:_get_image_description:218 | Error getting description for rag/knowledge/images/docx_media_img1.png: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 3
               │     └ 12
               └ <function _main at 0x1016f0cc0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 3
           │    └ <function BaseProcess._bootstrap at 0x1014a91c0>
           └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1014a8720>
    └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x169ce79e0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
    │    └ <function subprocess_started at 0x16a8558a0>
    └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x16a87dd30>>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
           │       │   │    └ <function Server.serve at 0x16a854cc0>
           │       │   └ <uvicorn.server.Server object at 0x16a87dd30>
           │       └ <function run at 0x10188b420>
           └ <module 'asyncio' from '/Users/jadoreran/miniconda3/lib/python3.12/asyncio/__init__.py'>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x16a836dc0>
           │      └ <function Runner.run at 0x101d3c220>
           └ <asyncio.runners.Runner object at 0x16a6ae8a0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/...
           │    │     └ <cyfunction Loop.run_until_complete at 0x16a8a2740>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x16a6ae8a0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x16a87ed20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188f0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x16fe5efc0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x16a87ed20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188f0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188f0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16fee3aa0>
          └ <fastapi.applications.FastAPI object at 0x16fe5efc0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x16fee5760>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16fee3aa0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'connection': 'keep-alive', 'content-length': '36646', 'sec-ch-ua-platform': '"macOS"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x16fee5760>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x16fee5120>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16fee3920>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x1700189b0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x16fee24b0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16fee3920>
          └ <function wrap_app_handling_exceptions at 0x16fe98a40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x16fee5800>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <fastapi.routing.APIRouter object at 0x16fee24b0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x16fee5800>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x16fee24b0>>
          └ <fastapi.routing.APIRouter object at 0x16fee24b0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x16fee5800>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │     └ <function Route.handle at 0x16fe9a020>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x16fee5800>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function request_response.<locals>.app at 0x16fee62a0>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x16fee5800>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x170018b30>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x16fee63e0>
          └ <function wrap_app_handling_exceptions at 0x16fe98a40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x16fee6520>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x16fee63e0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x170018b30>
                     └ <function get_request_handler.<locals>.app at 0x16fee6200>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x16fe99b20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': UploadFile(filename='media.docx', size=36401, headers=Headers({'content-disposition': 'form-data; name="file"; filen...
                 │         └ <function upload_file at 0x16fee58a0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=File(Pydant...

  File "/private/tmp/rag-demo/rag/src/rag/api.py", line 60, in upload_file
    processed_chunks = doc_processor.process_document(str(temp_path))
                       │             │                    └ PosixPath('/var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmpxut7g3w6/media.docx')
                       │             └ <function DocumentProcessor.process_document at 0x16346f100>
                       └ <rag.utils.document_processor.DocumentProcessor object at 0x170019040>

  File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 63, in process_document
    processed_text = self._describe_images_and_insert_placeholders(raw_text, extracted_images)
                     │    │                                        │         └ [PosixPath('rag/knowledge/images/docx_media_img1.png')]
                     │    │                                        └ '\n[image_placeholder:rag/knowledge/images/docx_media_img1.png]\nmedia_type\n\n\n\n\nend\n'
                     │    └ <function DocumentProcessor._describe_images_and_insert_placeholders at 0x163602d40>
                     └ <rag.utils.document_processor.DocumentProcessor object at 0x170019040>

  File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 165, in _describe_images_and_insert_placeholders
    description = self._get_image_description(img_path)
                  │    │                      └ PosixPath('rag/knowledge/images/docx_media_img1.png')
                  │    └ <function DocumentProcessor._get_image_description at 0x163602de0>
                  └ <rag.utils.document_processor.DocumentProcessor object at 0x170019040>

> File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 214, in _get_image_description
    response_body = self._invoke_bedrock("apac.amazon.nova-lite-v1:0", request_body)
                    │    │                                             └ {'messages': [{'role': 'user', 'content': [{'image': {'format': 'png', 'source': {'bytes': 'iVBORw0KGgoAAAANSUhEUgAAAZIAAAEzC...
                    │    └ <function DocumentProcessor._invoke_bedrock at 0x163602f20>
                    └ <rag.utils.document_processor.DocumentProcessor object at 0x170019040>

  File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 265, in _invoke_bedrock
    response = self.bedrock_client.invoke_model(
               │    │              └ <function ClientCreator._create_api_method.<locals>._api_call at 0x1707184a0>
               │    └ <botocore.client.BedrockRuntime object at 0x16a6732f0>
               └ <rag.utils.document_processor.DocumentProcessor object at 0x170019040>

  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/client.py", line 595, in _api_call
    return self._make_api_call(operation_name, kwargs)
           │    │              │               └ {'body': '{"messages": [{"role": "user", "content": [{"image": {"format": "png", "source": {"bytes": "iVBORw0KGgoAAAANSUhEUgA...
           │    │              └ 'InvokeModel'
           │    └ <function BaseClient._make_api_call at 0x160fc2980>
           └ <botocore.client.BedrockRuntime object at 0x16a6732f0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/context.py", line 123, in wrapper
    return func(*args, **kwargs)
           │     │       └ {}
           │     └ (<botocore.client.BedrockRuntime object at 0x16a6732f0>, 'InvokeModel', {'body': '{"messages": [{"role": "user", "content": [...
           └ <function BaseClient._make_api_call at 0x160fc28e0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/client.py", line 1058, in _make_api_call
    raise error_class(parsed_response, operation_name)
          │           │                └ 'InvokeModel'
          │           └ {'Error': {'Message': "You don't have access to the model with the specified model ID.", 'Code': 'AccessDeniedException'}, 'R...
          └ <class 'botocore.errorfactory.AccessDeniedException'>

botocore.errorfactory.AccessDeniedException: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
2025-07-21 16:27:59 | WARNING | rag.utils.document_processor:process_document:64 | Processed text: 
[image_info]{"description": "Error describing image: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.", "imgpath": "/private/tmp/rademo/rag/rag/knowledge/images/docx_media_img1.png"}[/image_info]
media_type




end

2025-07-21 16:27:59 | INFO  | rag.utils.document_processor:_generate_embeddings:233 | Generating embeddings for 1 chunks (real)...
2025-07-21 16:27:59 | ERROR | rag.utils.document_processor:_generate_embeddings:257 | Error generating embedding for chunk: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 3
               │     └ 12
               └ <function _main at 0x1016f0cc0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 3
           │    └ <function BaseProcess._bootstrap at 0x1014a91c0>
           └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1014a8720>
    └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x169ce79e0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
    │    └ <function subprocess_started at 0x16a8558a0>
    └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x16a87dd30>>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
           │       │   │    └ <function Server.serve at 0x16a854cc0>
           │       │   └ <uvicorn.server.Server object at 0x16a87dd30>
           │       └ <function run at 0x10188b420>
           └ <module 'asyncio' from '/Users/jadoreran/miniconda3/lib/python3.12/asyncio/__init__.py'>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x16a836dc0>
           │      └ <function Runner.run at 0x101d3c220>
           └ <asyncio.runners.Runner object at 0x16a6ae8a0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/...
           │    │     └ <cyfunction Loop.run_until_complete at 0x16a8a2740>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x16a6ae8a0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x16a87ed20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188f0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x16fe5efc0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x16a87ed20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188f0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188f0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16fee3aa0>
          └ <fastapi.applications.FastAPI object at 0x16fe5efc0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x16fee5760>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16fee3aa0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'connection': 'keep-alive', 'content-length': '36646', 'sec-ch-ua-platform': '"macOS"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x16fee5760>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x16fee5120>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16fee3920>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x1700189b0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x16fee24b0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16fee3920>
          └ <function wrap_app_handling_exceptions at 0x16fe98a40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x16fee5800>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <fastapi.routing.APIRouter object at 0x16fee24b0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x16fee5800>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x16fee24b0>>
          └ <fastapi.routing.APIRouter object at 0x16fee24b0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x16fee5800>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │     └ <function Route.handle at 0x16fe9a020>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x16fee5800>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function request_response.<locals>.app at 0x16fee62a0>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x16fee5800>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x170018b30>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x16fee63e0>
          └ <function wrap_app_handling_exceptions at 0x16fe98a40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x16fee6520>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x16fee63e0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x170018b30>
                     └ <function get_request_handler.<locals>.app at 0x16fee6200>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x16fe99b20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': UploadFile(filename='media.docx', size=36401, headers=Headers({'content-disposition': 'form-data; name="file"; filen...
                 │         └ <function upload_file at 0x16fee58a0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=File(Pydant...

  File "/private/tmp/rag-demo/rag/src/rag/api.py", line 60, in upload_file
    processed_chunks = doc_processor.process_document(str(temp_path))
                       │             │                    └ PosixPath('/var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmpxut7g3w6/media.docx')
                       │             └ <function DocumentProcessor.process_document at 0x16346f100>
                       └ <rag.utils.document_processor.DocumentProcessor object at 0x170019040>

  File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 70, in process_document
    processed_chunks = self._generate_embeddings(text_chunks)
                       │    │                    └ ['[image_info]{"description": "Error describing image: An error occurred (AccessDeniedException) when calling the InvokeModel...
                       │    └ <function DocumentProcessor._generate_embeddings at 0x163602e80>
                       └ <rag.utils.document_processor.DocumentProcessor object at 0x170019040>

> File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 243, in _generate_embeddings
    response = self.bedrock_client.invoke_model(
               │    │              └ <function ClientCreator._create_api_method.<locals>._api_call at 0x1707184a0>
               │    └ <botocore.client.BedrockRuntime object at 0x16a6732f0>
               └ <rag.utils.document_processor.DocumentProcessor object at 0x170019040>

  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/client.py", line 595, in _api_call
    return self._make_api_call(operation_name, kwargs)
           │    │              │               └ {'body': '{"inputText": "[image_info]{\\"description\\": \\"Error describing image: An error occurred (AccessDeniedException)...
           │    │              └ 'InvokeModel'
           │    └ <function BaseClient._make_api_call at 0x160fc2980>
           └ <botocore.client.BedrockRuntime object at 0x16a6732f0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/context.py", line 123, in wrapper
    return func(*args, **kwargs)
           │     │       └ {}
           │     └ (<botocore.client.BedrockRuntime object at 0x16a6732f0>, 'InvokeModel', {'body': '{"inputText": "[image_info]{\\"description\...
           └ <function BaseClient._make_api_call at 0x160fc28e0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/client.py", line 1058, in _make_api_call
    raise error_class(parsed_response, operation_name)
          │           │                └ 'InvokeModel'
          │           └ {'Error': {'Message': "You don't have access to the model with the specified model ID.", 'Code': 'AccessDeniedException'}, 'R...
          └ <class 'botocore.errorfactory.AccessDeniedException'>

botocore.errorfactory.AccessDeniedException: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
2025-07-21 16:27:59 | INFO  | rag.utils.document_processor:process_document:72 | Successfully processed 0 chunks from /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmpxut7g3w6/media.docx
2025-07-21 16:27:59 | WARNING | rag.api:upload_file:67 | No content could be processed from 'media.docx'.
2025-07-21 16:27:59 | ERROR | rag.api:upload_file:71 | An error occurred during file upload and processing: 400: No content could be processed from the file.
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 3
               │     └ 12
               └ <function _main at 0x1016f0cc0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 3
           │    └ <function BaseProcess._bootstrap at 0x1014a91c0>
           └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1014a8720>
    └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x169ce79e0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
    │    └ <function subprocess_started at 0x16a8558a0>
    └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x16a87dd30>>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
           │       │   │    └ <function Server.serve at 0x16a854cc0>
           │       │   └ <uvicorn.server.Server object at 0x16a87dd30>
           │       └ <function run at 0x10188b420>
           └ <module 'asyncio' from '/Users/jadoreran/miniconda3/lib/python3.12/asyncio/__init__.py'>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x16a836dc0>
           │      └ <function Runner.run at 0x101d3c220>
           └ <asyncio.runners.Runner object at 0x16a6ae8a0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/...
           │    │     └ <cyfunction Loop.run_until_complete at 0x16a8a2740>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x16a6ae8a0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x16a87ed20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188f0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x16fe5efc0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x16a87ed20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188f0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188f0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16fee3aa0>
          └ <fastapi.applications.FastAPI object at 0x16fe5efc0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x16fee5760>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16fee3aa0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'connection': 'keep-alive', 'content-length': '36646', 'sec-ch-ua-platform': '"macOS"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x16fee5760>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x16fee5120>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16fee3920>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x1700189b0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x16fee24b0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16fee3920>
          └ <function wrap_app_handling_exceptions at 0x16fe98a40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x16fee5800>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <fastapi.routing.APIRouter object at 0x16fee24b0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x16fee5800>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x16fee24b0>>
          └ <fastapi.routing.APIRouter object at 0x16fee24b0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x16fee5800>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │     └ <function Route.handle at 0x16fe9a020>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x16fee5800>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function request_response.<locals>.app at 0x16fee62a0>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x16fee5800>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x170018b30>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x16fee63e0>
          └ <function wrap_app_handling_exceptions at 0x16fe98a40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x16fee6520>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1700188...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x16fee63e0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x170018b30>
                     └ <function get_request_handler.<locals>.app at 0x16fee6200>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x16fe99b20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': UploadFile(filename='media.docx', size=36401, headers=Headers({'content-disposition': 'form-data; name="file"; filen...
                 │         └ <function upload_file at 0x16fee58a0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=File(Pydant...

> File "/private/tmp/rag-demo/rag/src/rag/api.py", line 68, in upload_file
    raise HTTPException(status_code=400, detail="No content could be processed from the file.")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 400: No content could be processed from the file.
2025-07-21 16:28:18 | INFO  | rag.api:upload_file:55 | File 'media.docx' uploaded to temporary path: /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmp4q1fqyvi/media.docx
2025-07-21 16:28:18 | INFO  | rag.utils.milvus_manager:__init__:17 | Successfully connected to Milvus.
2025-07-21 16:28:18 | INFO  | rag.utils.milvus_manager:_create_collection_if_not_exists:28 | Collection 'rag_collection' already exists.
2025-07-21 16:28:18 | INFO  | rag.utils.document_processor:process_document:58 | Processing document: /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmp4q1fqyvi/media.docx
2025-07-21 16:28:18 | INFO  | rag.utils.document_processor:_extract_from_docx:124 | Extracting from DOCX: /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmp4q1fqyvi/media.docx
2025-07-21 16:28:18 | INFO  | rag.utils.document_processor:_extract_from_docx:153 | Extracted 1 images from /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmp4q1fqyvi/media.docx
2025-07-21 16:28:18 | INFO  | rag.utils.document_processor:_describe_images_and_insert_placeholders:163 | Describing 1 images...
2025-07-21 16:28:18 | INFO  | rag.utils.document_processor:_get_image_description:186 | Getting description for rag/knowledge/images/docx_media_img1.png (real)...
2025-07-21 16:28:19 | ERROR | rag.utils.document_processor:_invoke_bedrock:273 | A Bedrock client error occurred when invoking apac.amazon.nova-lite-v1:0: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
2025-07-21 16:28:19 | ERROR | rag.utils.document_processor:_get_image_description:218 | Error getting description for rag/knowledge/images/docx_media_img1.png: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 3
               │     └ 12
               └ <function _main at 0x1016f0cc0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 3
           │    └ <function BaseProcess._bootstrap at 0x1014a91c0>
           └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1014a8720>
    └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x169ce79e0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
    │    └ <function subprocess_started at 0x16a8558a0>
    └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x16a87dd30>>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
           │       │   │    └ <function Server.serve at 0x16a854cc0>
           │       │   └ <uvicorn.server.Server object at 0x16a87dd30>
           │       └ <function run at 0x10188b420>
           └ <module 'asyncio' from '/Users/jadoreran/miniconda3/lib/python3.12/asyncio/__init__.py'>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x16a836dc0>
           │      └ <function Runner.run at 0x101d3c220>
           └ <asyncio.runners.Runner object at 0x16a6ae8a0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/...
           │    │     └ <cyfunction Loop.run_until_complete at 0x16a8a2740>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x16a6ae8a0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x16a87ed20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea150>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x16fe5efc0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x16a87ed20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea150>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea150>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16fee3aa0>
          └ <fastapi.applications.FastAPI object at 0x16fe5efc0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x137d49580>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16fee3aa0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'connection': 'keep-alive', 'content-length': '36646', 'sec-ch-ua-platform': '"macOS"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x137d49580>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x16fee5120>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16fee3920>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x1707ea1e0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x16fee24b0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16fee3920>
          └ <function wrap_app_handling_exceptions at 0x16fe98a40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1707e3a60>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <fastapi.routing.APIRouter object at 0x16fee24b0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1707e3a60>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x16fee24b0>>
          └ <fastapi.routing.APIRouter object at 0x16fee24b0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1707e3a60>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │     └ <function Route.handle at 0x16fe9a020>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1707e3a60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function request_response.<locals>.app at 0x16fee62a0>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1707e3a60>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x1707ea360>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1707e39c0>
          └ <function wrap_app_handling_exceptions at 0x16fe98a40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1707e3ba0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x1707e39c0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x1707ea360>
                     └ <function get_request_handler.<locals>.app at 0x16fee6200>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x16fe99b20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': UploadFile(filename='media.docx', size=36401, headers=Headers({'content-disposition': 'form-data; name="file"; filen...
                 │         └ <function upload_file at 0x16fee58a0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=File(Pydant...

  File "/private/tmp/rag-demo/rag/src/rag/api.py", line 60, in upload_file
    processed_chunks = doc_processor.process_document(str(temp_path))
                       │             │                    └ PosixPath('/var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmp4q1fqyvi/media.docx')
                       │             └ <function DocumentProcessor.process_document at 0x16346f100>
                       └ <rag.utils.document_processor.DocumentProcessor object at 0x170018ad0>

  File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 63, in process_document
    processed_text = self._describe_images_and_insert_placeholders(raw_text, extracted_images)
                     │    │                                        │         └ [PosixPath('rag/knowledge/images/docx_media_img1.png')]
                     │    │                                        └ '\n[image_placeholder:rag/knowledge/images/docx_media_img1.png]\nmedia_type\n\n\n\n\nend\n'
                     │    └ <function DocumentProcessor._describe_images_and_insert_placeholders at 0x163602d40>
                     └ <rag.utils.document_processor.DocumentProcessor object at 0x170018ad0>

  File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 165, in _describe_images_and_insert_placeholders
    description = self._get_image_description(img_path)
                  │    │                      └ PosixPath('rag/knowledge/images/docx_media_img1.png')
                  │    └ <function DocumentProcessor._get_image_description at 0x163602de0>
                  └ <rag.utils.document_processor.DocumentProcessor object at 0x170018ad0>

> File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 214, in _get_image_description
    response_body = self._invoke_bedrock("apac.amazon.nova-lite-v1:0", request_body)
                    │    │                                             └ {'messages': [{'role': 'user', 'content': [{'image': {'format': 'png', 'source': {'bytes': 'iVBORw0KGgoAAAANSUhEUgAAAZIAAAEzC...
                    │    └ <function DocumentProcessor._invoke_bedrock at 0x163602f20>
                    └ <rag.utils.document_processor.DocumentProcessor object at 0x170018ad0>

  File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 265, in _invoke_bedrock
    response = self.bedrock_client.invoke_model(
               │    │              └ <function ClientCreator._create_api_method.<locals>._api_call at 0x170ebc040>
               │    └ <botocore.client.BedrockRuntime object at 0x16fee34a0>
               └ <rag.utils.document_processor.DocumentProcessor object at 0x170018ad0>

  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/client.py", line 595, in _api_call
    return self._make_api_call(operation_name, kwargs)
           │    │              │               └ {'body': '{"messages": [{"role": "user", "content": [{"image": {"format": "png", "source": {"bytes": "iVBORw0KGgoAAAANSUhEUgA...
           │    │              └ 'InvokeModel'
           │    └ <function BaseClient._make_api_call at 0x160fc2980>
           └ <botocore.client.BedrockRuntime object at 0x16fee34a0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/context.py", line 123, in wrapper
    return func(*args, **kwargs)
           │     │       └ {}
           │     └ (<botocore.client.BedrockRuntime object at 0x16fee34a0>, 'InvokeModel', {'body': '{"messages": [{"role": "user", "content": [...
           └ <function BaseClient._make_api_call at 0x160fc28e0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/client.py", line 1058, in _make_api_call
    raise error_class(parsed_response, operation_name)
          │           │                └ 'InvokeModel'
          │           └ {'Error': {'Message': "You don't have access to the model with the specified model ID.", 'Code': 'AccessDeniedException'}, 'R...
          └ <class 'botocore.errorfactory.AccessDeniedException'>

botocore.errorfactory.AccessDeniedException: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
2025-07-21 16:28:19 | WARNING | rag.utils.document_processor:process_document:64 | Processed text: 
[image_info]{"description": "Error describing image: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.", "imgpath": "/private/tmp/rademo/rag/rag/knowledge/images/docx_media_img1.png"}[/image_info]
media_type




end

2025-07-21 16:28:19 | INFO  | rag.utils.document_processor:_generate_embeddings:233 | Generating embeddings for 1 chunks (real)...
2025-07-21 16:28:19 | ERROR | rag.utils.document_processor:_generate_embeddings:257 | Error generating embedding for chunk: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 3
               │     └ 12
               └ <function _main at 0x1016f0cc0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 3
           │    └ <function BaseProcess._bootstrap at 0x1014a91c0>
           └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1014a8720>
    └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x169ce79e0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
    │    └ <function subprocess_started at 0x16a8558a0>
    └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x16a87dd30>>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
           │       │   │    └ <function Server.serve at 0x16a854cc0>
           │       │   └ <uvicorn.server.Server object at 0x16a87dd30>
           │       └ <function run at 0x10188b420>
           └ <module 'asyncio' from '/Users/jadoreran/miniconda3/lib/python3.12/asyncio/__init__.py'>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x16a836dc0>
           │      └ <function Runner.run at 0x101d3c220>
           └ <asyncio.runners.Runner object at 0x16a6ae8a0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/...
           │    │     └ <cyfunction Loop.run_until_complete at 0x16a8a2740>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x16a6ae8a0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x16a87ed20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea150>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x16fe5efc0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x16a87ed20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea150>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea150>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16fee3aa0>
          └ <fastapi.applications.FastAPI object at 0x16fe5efc0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x137d49580>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16fee3aa0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'connection': 'keep-alive', 'content-length': '36646', 'sec-ch-ua-platform': '"macOS"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x137d49580>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x16fee5120>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16fee3920>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x1707ea1e0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x16fee24b0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16fee3920>
          └ <function wrap_app_handling_exceptions at 0x16fe98a40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1707e3a60>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <fastapi.routing.APIRouter object at 0x16fee24b0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1707e3a60>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x16fee24b0>>
          └ <fastapi.routing.APIRouter object at 0x16fee24b0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1707e3a60>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │     └ <function Route.handle at 0x16fe9a020>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1707e3a60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function request_response.<locals>.app at 0x16fee62a0>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1707e3a60>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x1707ea360>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1707e39c0>
          └ <function wrap_app_handling_exceptions at 0x16fe98a40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1707e3ba0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x1707e39c0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x1707ea360>
                     └ <function get_request_handler.<locals>.app at 0x16fee6200>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x16fe99b20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': UploadFile(filename='media.docx', size=36401, headers=Headers({'content-disposition': 'form-data; name="file"; filen...
                 │         └ <function upload_file at 0x16fee58a0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=File(Pydant...

  File "/private/tmp/rag-demo/rag/src/rag/api.py", line 60, in upload_file
    processed_chunks = doc_processor.process_document(str(temp_path))
                       │             │                    └ PosixPath('/var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmp4q1fqyvi/media.docx')
                       │             └ <function DocumentProcessor.process_document at 0x16346f100>
                       └ <rag.utils.document_processor.DocumentProcessor object at 0x170018ad0>

  File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 70, in process_document
    processed_chunks = self._generate_embeddings(text_chunks)
                       │    │                    └ ['[image_info]{"description": "Error describing image: An error occurred (AccessDeniedException) when calling the InvokeModel...
                       │    └ <function DocumentProcessor._generate_embeddings at 0x163602e80>
                       └ <rag.utils.document_processor.DocumentProcessor object at 0x170018ad0>

> File "/private/tmp/rag-demo/rag/src/rag/utils/document_processor.py", line 243, in _generate_embeddings
    response = self.bedrock_client.invoke_model(
               │    │              └ <function ClientCreator._create_api_method.<locals>._api_call at 0x170ebc040>
               │    └ <botocore.client.BedrockRuntime object at 0x16fee34a0>
               └ <rag.utils.document_processor.DocumentProcessor object at 0x170018ad0>

  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/client.py", line 595, in _api_call
    return self._make_api_call(operation_name, kwargs)
           │    │              │               └ {'body': '{"inputText": "[image_info]{\\"description\\": \\"Error describing image: An error occurred (AccessDeniedException)...
           │    │              └ 'InvokeModel'
           │    └ <function BaseClient._make_api_call at 0x160fc2980>
           └ <botocore.client.BedrockRuntime object at 0x16fee34a0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/context.py", line 123, in wrapper
    return func(*args, **kwargs)
           │     │       └ {}
           │     └ (<botocore.client.BedrockRuntime object at 0x16fee34a0>, 'InvokeModel', {'body': '{"inputText": "[image_info]{\\"description\...
           └ <function BaseClient._make_api_call at 0x160fc28e0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/botocore/client.py", line 1058, in _make_api_call
    raise error_class(parsed_response, operation_name)
          │           │                └ 'InvokeModel'
          │           └ {'Error': {'Message': "You don't have access to the model with the specified model ID.", 'Code': 'AccessDeniedException'}, 'R...
          └ <class 'botocore.errorfactory.AccessDeniedException'>

botocore.errorfactory.AccessDeniedException: An error occurred (AccessDeniedException) when calling the InvokeModel operation: You don't have access to the model with the specified model ID.
2025-07-21 16:28:19 | INFO  | rag.utils.document_processor:process_document:72 | Successfully processed 0 chunks from /var/folders/wy/y014_qf56fb9h06s0f1dx1ww0000gn/T/tmp4q1fqyvi/media.docx
2025-07-21 16:28:19 | WARNING | rag.api:upload_file:67 | No content could be processed from 'media.docx'.
2025-07-21 16:28:19 | ERROR | rag.api:upload_file:71 | An error occurred during file upload and processing: 400: No content could be processed from the file.
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 3
               │     └ 12
               └ <function _main at 0x1016f0cc0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 3
           │    └ <function BaseProcess._bootstrap at 0x1014a91c0>
           └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1014a8720>
    └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x169ce79e0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
    │    └ <function subprocess_started at 0x16a8558a0>
    └ <SpawnProcess name='SpawnProcess-1' parent=47549 started>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x16a87dd30>>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=8, family=2, type=1, proto=0, laddr=('0.0.0.0', 8002)>]
           │       │   │    └ <function Server.serve at 0x16a854cc0>
           │       │   └ <uvicorn.server.Server object at 0x16a87dd30>
           │       └ <function run at 0x10188b420>
           └ <module 'asyncio' from '/Users/jadoreran/miniconda3/lib/python3.12/asyncio/__init__.py'>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x16a836dc0>
           │      └ <function Runner.run at 0x101d3c220>
           └ <asyncio.runners.Runner object at 0x16a6ae8a0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/...
           │    │     └ <cyfunction Loop.run_until_complete at 0x16a8a2740>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x16a6ae8a0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x16a87ed20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea150>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x16fe5efc0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x16a87ed20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea150>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea150>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16fee3aa0>
          └ <fastapi.applications.FastAPI object at 0x16fe5efc0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x137d49580>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16fee3aa0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8002', 'connection': 'keep-alive', 'content-length': '36646', 'sec-ch-ua-platform': '"macOS"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x137d49580>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x16fee5120>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16fee3920>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x16fee3b30>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x1707ea1e0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x16fee24b0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16fee3920>
          └ <function wrap_app_handling_exceptions at 0x16fe98a40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1707e3a60>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <fastapi.routing.APIRouter object at 0x16fee24b0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1707e3a60>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x16fee24b0>>
          └ <fastapi.routing.APIRouter object at 0x16fee24b0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1707e3a60>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │     └ <function Route.handle at 0x16fe9a020>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1707e3a60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │    └ <function request_response.<locals>.app at 0x16fee62a0>
          └ APIRoute(path='/upload', name='upload_file', methods=['POST'])
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1707e3a60>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x1707ea360>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1707e39c0>
          └ <function wrap_app_handling_exceptions at 0x16fe98a40>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1707e3ba0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1707ea1...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8002), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x1707e39c0>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x1707ea360>
                     └ <function get_request_handler.<locals>.app at 0x16fee6200>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x16fe99b20>
  File "/Users/jadoreran/miniconda3/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'file': UploadFile(filename='media.docx', size=36401, headers=Headers({'content-disposition': 'form-data; name="file"; filen...
                 │         └ <function upload_file at 0x16fee58a0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=File(Pydant...

> File "/private/tmp/rag-demo/rag/src/rag/api.py", line 68, in upload_file
    raise HTTPException(status_code=400, detail="No content could be processed from the file.")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 400: No content could be processed from the file.

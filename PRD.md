好的，明白了。我们来更新这份 PRD，加入文件上传页面，并修正 `/query` 接口的响应结构。

这是更新后的版本：

---

# **PRD: HR 智能助手前端界面 (v1.1)**

## 1. 文档概述

### 1.1 项目背景
我们已经使用 FastAPI 构建了一个强大的后端 HR 问答服务。该服务能够通过 `/upload` 接口接收和处理知识库文档，并通过 `/query` 接口根据用户提问，从知识库中检索信息并生成高质量的回答。本项目旨在为此后端服务打造一个功能完整、体验一流的前端应用。

### 1.2 项目目标
- **功能目标**: 构建一个 Web 前端，实现用户登录、**文件上传**、与后端 API 实时对话、展示问答历史等核心功能。
- **体验目标**: 提供一个视觉吸引力强、交互流畅、响应迅速的用户界面，提升用户的使用体验和信任感。
- **技术目标**: 采用 React + Vite + Tailwind CSS/shadcn/ui 技术栈，构建一个高性能、可维护、易扩展的前端应用。
- **安全目标**: 实现一个基础的硬编码用户认证机制，以保护在线 Demo 不被随意访问。

### 1.3 目标用户
- **主要用户 (聊天功能)**: 公司内部员工，他们需要快速查询 HR 政策、福利、流程等信息。
- **主要用户 (上传功能)**: HR 管理员或项目维护者，他们需要方便地更新系统的知识库。
- **次要用户**: 项目演示和评估人员。

## 2. 功能需求 (Functional Requirements)

### 2.1 Feature 1: 用户认证 (User Authentication)

**用户故事**: "作为一个访问者，我希望能通过一个指定的密码登录系统，以确保只有授权人员才能访问这个内部演示工具。"

**需求描述**:
- **登录页面**: 应用的入口应为一个居中的、简约的登录框。
- **输入字段**: 包含一个密码输入框 (`<input type="password">`) 和一个“进入”或“登录”按钮。
- **认证逻辑**:
    - 前端硬编码一个相对复杂的密码。
    - **验证成功**: 跳转到主聊天界面。
    - **验证失败**: 显示清晰的错误提示，例如“密码错误，请重试”。

---

### 2.2 Feature 2: 核心聊天界面 (Chat Interface)

**用户故事**: "作为一名员工，我希望能在一个类似即时通讯的界面里输入我的问题，并能清晰地看到机器人的回答，整个对话过程应该像和真人聊天一样自然。"

**需求描述**:
- **界面布局**:
    - **对话历史区**: 占据页面大部分空间。
    - **问题输入区**: 位于页面底部，包含文本输入框和“发送”按钮。
- **对话展示**:
    - 用户的提问消息气泡靠右对齐，机器人的回答消息气泡靠左对齐，颜色区分。
- **交互逻辑**:
    - 支持按 `Enter` 键或点击按钮发送。
    - 发送后，输入框清空，问题立即显示在对话区。
    - 在等待后端响应时，必须有明确的加载动画（例如“正在思考中...”并附上动效）。



---

### 2.3 Feature 3: 文件上传页面 (File Upload Page) ✨ **(新增)**

**用户故事**: "作为 HR 管理员，我希望能直接在网页上上传最新的公司政策文档（如 PDF, DOCX），以便让智能助手学习并更新知识库。"

**需求描述**:
- **页面入口**: 在主应用界面（例如，聊天页面的页眉或侧边栏）提供一个清晰的导航入口，如“上传文档”按钮或链接，引导用户进入上传页面。
- **界面布局**:
    - 页面包含一个明确的标题，如“知识库文档上传”。
    - 一个文件选择区域，**强烈建议支持拖拽上传**。该区域应有文字提示，如“将文件拖拽至此，或点击选择文件”。
    - 一个“上传”按钮，在未选择文件时应为禁用状态。
- **上传流程**:
    1.  用户选择或拖拽一个文件（前端可限制文件类型为 `.pdf`, `.docx` 等）。
    2.  用户点击“上传”按钮。按钮应变为加载状态，防止重复点击。
    3.  前端以 `multipart/form-data` 格式向后端的 `POST /upload` 接口发送请求。
    4.  **处理中状态**: 界面显示一个明确的全局提示，告知用户文件正在上传和处理中，例如：“文件正在上传处理中，这可能需要一些时间，请稍候...”。
    5.  **成功响应**: 收到后端成功响应后（例如 `{"message": "File 'example.pdf' uploaded and processed successfully."}`），在界面上显示此成功消息，并提供一个返回聊天页面的链接。
    6.  **失败响应**: 如果上传或处理失败，显示一个清晰的错误提示。

---

### 2.4 Feature 4: API 集成与数据流 (API Integration & Data Flow)

**用户故事**: "作为用户，当我发送一个问题后，我期望系统能快速将我的问题发送给后端进行处理，并将生成的答案展示给我。"

**需求描述**:
- **Query API (`/query`)**:
    - **请求**: `POST /query`，请求体 (Body) 格式为 `{"query": "用户输入的问题内容"}`。
    - **响应**: ✨ **(已更新)** 成功响应体格式为 `{"answer": {"raw": "这是生成的答案..."}}`。前端在拿到数据后，需要解析 `response.data.answer.raw` 来获取并展示最终的回答文本。
- **Upload API (`/upload`)**:
    - **请求**: `POST /upload`，请求体格式为 `multipart/form-data`。
    - **响应**: 成功响应体格式为 `{"message": "File '...' uploaded and processed successfully."}`。
- **错误处理**: 任何 API 请求失败都应在界面上给予用户友好的错误提示。

---

### 2.5 Feature 5: 对话状态管理 (Conversation State Management)

**用户故事**: "作为用户，如果我不小心刷新了浏览器页面，我希望之前的对话记录不会丢失。"

**需求描述**:
- **会话持久化**: 整个对话历史存储在浏览器的 `sessionStorage` 中。
- **状态恢复**: 页面加载时，自动从 `sessionStorage` 恢复对话历史。若无历史，则显示欢迎语。

## 3. 非功能需求 (Non-Functional Requirements)

### 3.1 UI/UX 设计 (UI/UX Design)
- **视觉风格**:
    - **科技感**: 采用深色主题，搭配明亮的强调色，营造未来感。
    - **现代化**: 使用 Tailwind CSS 和/或 shadcn/ui 构建，确保组件外观现代、一致。
- **交互动画**:
    - 平滑的页面过渡和元素动画。
    - 按钮、输入框等元素的即时视觉反馈。
    - **(推荐)** 助手的回答采用“打字机效果”逐字显示。
- **响应式布局**: 必须同时适配桌面和主流移动设备。

### 3.2 性能 (Performance)
- **快速加载**: 基于 Vite 的快速冷启动和热更新。
- **流畅交互**: 即使对话记录很长，页面滚动和消息渲染也应保持流畅。

### 3.3 技术栈 (Technology Stack)
- **核心框架**: React
- **构建工具**: Vite
- **CSS 方案**: Tailwind CSS
- **组件库**: shadcn/ui (推荐)
- **状态管理**: React Hooks (`useState`, `useEffect`) 结合 `sessionStorage` API

## 4. 范围之外 (Out of Scope)
- **多用户系统**: 不支持多用户注册和独立账户。
- **历史对话搜索**: 不提供在当前对话中搜索关键词的功能。
- **多语言支持**: 界面和交互仅支持ENGLISH。